(()=>{var e={};e.id=276,e.ids=[276],e.modules={397:(e,t,s)=>{var r;(()=>{var n={226:function(n,i){!function(a,o){"use strict";var l="function",c="undefined",u="object",h="string",d="major",f="model",p="name",m="type",g="vendor",b="version",w="architecture",y="console",_="mobile",v="tablet",x="smarttv",S="wearable",k="embedded",O="Amazon",R="Apple",A="ASUS",$="BlackBerry",E="Browser",I="Chrome",P="Firefox",T="Google",j="Huawei",N="Microsoft",C="Motorola",M="Opera",q="Samsung",D="Sharp",L="Sony",B="Xiaomi",U="Zebra",W="Facebook",F="Chromium OS",X="Mac OS",H=function(e,t){var s={};for(var r in e)t[r]&&t[r].length%2==0?s[r]=t[r].concat(e[r]):s[r]=e[r];return s},z=function(e){for(var t={},s=0;s<e.length;s++)t[e[s].toUpperCase()]=e[s];return t},J=function(e,t){return typeof e===h&&-1!==V(t).indexOf(V(e))},V=function(e){return e.toLowerCase()},K=function(e,t){if(typeof e===h)return e=e.replace(/^\s\s*/,""),typeof t===c?e:e.substring(0,350)},G=function(e,t){for(var s,r,n,i,a,c,h=0;h<t.length&&!a;){var d=t[h],f=t[h+1];for(s=r=0;s<d.length&&!a&&d[s];)if(a=d[s++].exec(e))for(n=0;n<f.length;n++)c=a[++r],typeof(i=f[n])===u&&i.length>0?2===i.length?typeof i[1]==l?this[i[0]]=i[1].call(this,c):this[i[0]]=i[1]:3===i.length?typeof i[1]!==l||i[1].exec&&i[1].test?this[i[0]]=c?c.replace(i[1],i[2]):void 0:this[i[0]]=c?i[1].call(this,c,i[2]):void 0:4===i.length&&(this[i[0]]=c?i[3].call(this,c.replace(i[1],i[2])):o):this[i]=c||o;h+=2}},Q=function(e,t){for(var s in t)if(typeof t[s]===u&&t[s].length>0){for(var r=0;r<t[s].length;r++)if(J(t[s][r],e))return"?"===s?o:s}else if(J(t[s],e))return"?"===s?o:s;return e},Y={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Z={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[b,[p,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[b,[p,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[p,b],[/opios[\/ ]+([\w\.]+)/i],[b,[p,M+" Mini"]],[/\bopr\/([\w\.]+)/i],[b,[p,M]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[p,b],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[b,[p,"UC"+E]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[b,[p,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[b,[p,"WeChat"]],[/konqueror\/([\w\.]+)/i],[b,[p,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[b,[p,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[b,[p,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[p,/(.+)/,"$1 Secure "+E],b],[/\bfocus\/([\w\.]+)/i],[b,[p,P+" Focus"]],[/\bopt\/([\w\.]+)/i],[b,[p,M+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[b,[p,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[b,[p,"Dolphin"]],[/coast\/([\w\.]+)/i],[b,[p,M+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[b,[p,"MIUI "+E]],[/fxios\/([-\w\.]+)/i],[b,[p,P]],[/\bqihu|(qi?ho?o?|360)browser/i],[[p,"360 "+E]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[p,/(.+)/,"$1 "+E],b],[/(comodo_dragon)\/([\w\.]+)/i],[[p,/_/g," "],b],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[p,b],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[p],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[p,W],b],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[p,b],[/\bgsa\/([\w\.]+) .*safari\//i],[b,[p,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[b,[p,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[b,[p,I+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[p,I+" WebView"],b],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[b,[p,"Android "+E]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[p,b],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[b,[p,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[b,p],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[p,[b,Q,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[p,b],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[p,"Netscape"],b],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[b,[p,P+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[p,b],[/(cobalt)\/([\w\.]+)/i],[p,[b,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[w,"amd64"]],[/(ia32(?=;))/i],[[w,V]],[/((?:i[346]|x)86)[;\)]/i],[[w,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[w,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[w,"armhf"]],[/windows (ce|mobile); ppc;/i],[[w,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[w,/ower/,"",V]],[/(sun4\w)[;\)]/i],[[w,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[w,V]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[f,[g,q],[m,v]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[f,[g,q],[m,_]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[f,[g,R],[m,_]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[f,[g,R],[m,v]],[/(macintosh);/i],[f,[g,R]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[f,[g,D],[m,_]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[f,[g,j],[m,v]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[f,[g,j],[m,_]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[f,/_/g," "],[g,B],[m,_]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[f,/_/g," "],[g,B],[m,v]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[f,[g,"OPPO"],[m,_]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[f,[g,"Vivo"],[m,_]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[f,[g,"Realme"],[m,_]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[f,[g,C],[m,_]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[f,[g,C],[m,v]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[f,[g,"LG"],[m,v]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[f,[g,"LG"],[m,_]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[f,[g,"Lenovo"],[m,v]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[f,/_/g," "],[g,"Nokia"],[m,_]],[/(pixel c)\b/i],[f,[g,T],[m,v]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[f,[g,T],[m,_]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[f,[g,L],[m,_]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[f,"Xperia Tablet"],[g,L],[m,v]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[f,[g,"OnePlus"],[m,_]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[f,[g,O],[m,v]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[f,/(.+)/g,"Fire Phone $1"],[g,O],[m,_]],[/(playbook);[-\w\),; ]+(rim)/i],[f,g,[m,v]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[f,[g,$],[m,_]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[f,[g,A],[m,v]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[f,[g,A],[m,_]],[/(nexus 9)/i],[f,[g,"HTC"],[m,v]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[g,[f,/_/g," "],[m,_]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[f,[g,"Acer"],[m,v]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[f,[g,"Meizu"],[m,_]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[g,f,[m,_]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[g,f,[m,v]],[/(surface duo)/i],[f,[g,N],[m,v]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[f,[g,"Fairphone"],[m,_]],[/(u304aa)/i],[f,[g,"AT&T"],[m,_]],[/\bsie-(\w*)/i],[f,[g,"Siemens"],[m,_]],[/\b(rct\w+) b/i],[f,[g,"RCA"],[m,v]],[/\b(venue[\d ]{2,7}) b/i],[f,[g,"Dell"],[m,v]],[/\b(q(?:mv|ta)\w+) b/i],[f,[g,"Verizon"],[m,v]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[f,[g,"Barnes & Noble"],[m,v]],[/\b(tm\d{3}\w+) b/i],[f,[g,"NuVision"],[m,v]],[/\b(k88) b/i],[f,[g,"ZTE"],[m,v]],[/\b(nx\d{3}j) b/i],[f,[g,"ZTE"],[m,_]],[/\b(gen\d{3}) b.+49h/i],[f,[g,"Swiss"],[m,_]],[/\b(zur\d{3}) b/i],[f,[g,"Swiss"],[m,v]],[/\b((zeki)?tb.*\b) b/i],[f,[g,"Zeki"],[m,v]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[g,"Dragon Touch"],f,[m,v]],[/\b(ns-?\w{0,9}) b/i],[f,[g,"Insignia"],[m,v]],[/\b((nxa|next)-?\w{0,9}) b/i],[f,[g,"NextBook"],[m,v]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[g,"Voice"],f,[m,_]],[/\b(lvtel\-)?(v1[12]) b/i],[[g,"LvTel"],f,[m,_]],[/\b(ph-1) /i],[f,[g,"Essential"],[m,_]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[f,[g,"Envizen"],[m,v]],[/\b(trio[-\w\. ]+) b/i],[f,[g,"MachSpeed"],[m,v]],[/\btu_(1491) b/i],[f,[g,"Rotor"],[m,v]],[/(shield[\w ]+) b/i],[f,[g,"Nvidia"],[m,v]],[/(sprint) (\w+)/i],[g,f,[m,_]],[/(kin\.[onetw]{3})/i],[[f,/\./g," "],[g,N],[m,_]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[f,[g,U],[m,v]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[f,[g,U],[m,_]],[/smart-tv.+(samsung)/i],[g,[m,x]],[/hbbtv.+maple;(\d+)/i],[[f,/^/,"SmartTV"],[g,q],[m,x]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[g,"LG"],[m,x]],[/(apple) ?tv/i],[g,[f,R+" TV"],[m,x]],[/crkey/i],[[f,I+"cast"],[g,T],[m,x]],[/droid.+aft(\w)( bui|\))/i],[f,[g,O],[m,x]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[f,[g,D],[m,x]],[/(bravia[\w ]+)( bui|\))/i],[f,[g,L],[m,x]],[/(mitv-\w{5}) bui/i],[f,[g,B],[m,x]],[/Hbbtv.*(technisat) (.*);/i],[g,f,[m,x]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[g,K],[f,K],[m,x]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[m,x]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[g,f,[m,y]],[/droid.+; (shield) bui/i],[f,[g,"Nvidia"],[m,y]],[/(playstation [345portablevi]+)/i],[f,[g,L],[m,y]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[f,[g,N],[m,y]],[/((pebble))app/i],[g,f,[m,S]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[f,[g,R],[m,S]],[/droid.+; (glass) \d/i],[f,[g,T],[m,S]],[/droid.+; (wt63?0{2,3})\)/i],[f,[g,U],[m,S]],[/(quest( 2| pro)?)/i],[f,[g,W],[m,S]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[g,[m,k]],[/(aeobc)\b/i],[f,[g,O],[m,k]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[f,[m,_]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[f,[m,v]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[m,v]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[m,_]],[/(android[-\w\. ]{0,9});.+buil/i],[f,[g,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[b,[p,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[b,[p,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[p,b],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[b,p]],os:[[/microsoft (windows) (vista|xp)/i],[p,b],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[p,[b,Q,Y]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[p,"Windows"],[b,Q,Y]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/ios;fbsv\/([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[b,/_/g,"."],[p,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[p,X],[b,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[b,p],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[p,b],[/\(bb(10);/i],[b,[p,$]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[b,[p,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[b,[p,P+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[b,[p,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[b,[p,"watchOS"]],[/crkey\/([\d\.]+)/i],[b,[p,I+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[p,F],b],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[p,b],[/(sunos) ?([\w\.\d]*)/i],[[p,"Solaris"],b],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[p,b]]},ee=function(e,t){if(typeof e===u&&(t=e,e=o),!(this instanceof ee))return new ee(e,t).getResult();var s=typeof a!==c&&a.navigator?a.navigator:o,r=e||(s&&s.userAgent?s.userAgent:""),n=s&&s.userAgentData?s.userAgentData:o,i=t?H(Z,t):Z,y=s&&s.userAgent==r;return this.getBrowser=function(){var e,t={};return t[p]=o,t[b]=o,G.call(t,r,i.browser),t[d]=typeof(e=t[b])===h?e.replace(/[^\d\.]/g,"").split(".")[0]:o,y&&s&&s.brave&&typeof s.brave.isBrave==l&&(t[p]="Brave"),t},this.getCPU=function(){var e={};return e[w]=o,G.call(e,r,i.cpu),e},this.getDevice=function(){var e={};return e[g]=o,e[f]=o,e[m]=o,G.call(e,r,i.device),y&&!e[m]&&n&&n.mobile&&(e[m]=_),y&&"Macintosh"==e[f]&&s&&typeof s.standalone!==c&&s.maxTouchPoints&&s.maxTouchPoints>2&&(e[f]="iPad",e[m]=v),e},this.getEngine=function(){var e={};return e[p]=o,e[b]=o,G.call(e,r,i.engine),e},this.getOS=function(){var e={};return e[p]=o,e[b]=o,G.call(e,r,i.os),y&&!e[p]&&n&&"Unknown"!=n.platform&&(e[p]=n.platform.replace(/chrome os/i,F).replace(/macos/i,X)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return r},this.setUA=function(e){return r=typeof e===h&&e.length>350?K(e,350):e,this},this.setUA(r),this};ee.VERSION="1.0.35",ee.BROWSER=z([p,b,d]),ee.CPU=z([w]),ee.DEVICE=z([f,g,m,y,_,x,v,S,k]),ee.ENGINE=ee.OS=z([p,b]),typeof i!==c?(n.exports&&(i=n.exports=ee),i.UAParser=ee):s.amdO?void 0===(r=(function(){return ee}).call(t,s,t,e))||(e.exports=r):typeof a!==c&&(a.UAParser=ee);var et=typeof a!==c&&(a.jQuery||a.Zepto);if(et&&!et.ua){var es=new ee;et.ua=es.getResult(),et.ua.get=function(){return es.getUA()},et.ua.set=function(e){es.setUA(e);var t=es.getResult();for(var s in t)et.ua[s]=t[s]}}}("object"==typeof window?window:this)}},i={};function a(e){var t=i[e];if(void 0!==t)return t.exports;var s=i[e]={exports:{}},r=!0;try{n[e].call(s.exports,s,s.exports,a),r=!1}finally{r&&delete i[e]}return s.exports}a.ab=__dirname+"/",e.exports=a(226)})()},720:(e,t,s)=>{"use strict";let r,n,i,a;s.r(t),s.d(t,{patchFetch:()=>rm,routeModule:()=>rh,serverHooks:()=>rp,workAsyncStorage:()=>rd,workUnitAsyncStorage:()=>rf});var o,l,c,u,h,d,f,p,m,g,b,w,y,_,v,x,S,k,O,R,A,$,E,I,P,T,j,N,C,M,q,D,L,B,U,W,F,X,H,z,J,V,K,G,Q,Y,Z,ee,et,es,er,en,ei,ea,eo,el,ec,eu,eh,ed,ef,ep,em,eg,eb,ew,ey,e_,ev,ex,eS,ek,eO,eR,eA,e$,eE={};s.r(eE),s.d(eE,{POST:()=>ru});var eI=s(6559),eP=s(8088),eT=s(7719),ej=s(4525);function eN(e,t,s,r,n){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!n)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?n.call(e,s):n?n.value=s:t.set(e,s),s}function eC(e,t,s,r){if("a"===s&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?r:"a"===s?r.call(e):r?r.value:t.get(e)}let eM=function(){let{crypto:e}=globalThis;if(e?.randomUUID)return eM=e.randomUUID.bind(e),e.randomUUID();let t=new Uint8Array(1),s=e?()=>e.getRandomValues(t)[0]:()=>255*Math.random()&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(e^s()&15>>e/4).toString(16))};function eq(e){return"object"==typeof e&&null!==e&&("name"in e&&"AbortError"===e.name||"message"in e&&String(e.message).includes("FetchRequestCanceledException"))}let eD=e=>{if(e instanceof Error)return e;if("object"==typeof e&&null!==e){try{if("[object Error]"===Object.prototype.toString.call(e)){let t=Error(e.message,e.cause?{cause:e.cause}:{});return e.stack&&(t.stack=e.stack),e.cause&&!t.cause&&(t.cause=e.cause),e.name&&(t.name=e.name),t}}catch{}try{return Error(JSON.stringify(e))}catch{}}return Error(e)};class eL extends Error{}class eB extends eL{constructor(e,t,s,r){super(`${eB.makeMessage(e,t,s)}`),this.status=e,this.headers=r,this.requestID=r?.get("x-request-id"),this.error=t,this.code=t?.code,this.param=t?.param,this.type=t?.type}static makeMessage(e,t,s){let r=t?.message?"string"==typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):s;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,s,r){if(!e||!r)return new eW({message:s,cause:eD(t)});let n=t?.error;return 400===e?new eX(e,n,s,r):401===e?new eH(e,n,s,r):403===e?new ez(e,n,s,r):404===e?new eJ(e,n,s,r):409===e?new eV(e,n,s,r):422===e?new eK(e,n,s,r):429===e?new eG(e,n,s,r):e>=500?new eQ(e,n,s,r):new eB(e,n,s,r)}}class eU extends eB{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class eW extends eB{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class eF extends eW{constructor({message:e}={}){super({message:e??"Request timed out."})}}class eX extends eB{}class eH extends eB{}class ez extends eB{}class eJ extends eB{}class eV extends eB{}class eK extends eB{}class eG extends eB{}class eQ extends eB{}class eY extends eL{constructor(){super("Could not parse response content as the length limit was reached")}}class eZ extends eL{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class e0 extends Error{constructor(e){super(e)}}let e1=/^[a-z][a-z0-9+.-]*:/i,e2=e=>e1.test(e),e3=e=>(e3=Array.isArray)(e),e4=e3;function e6(e){return null!=e&&"object"==typeof e&&!Array.isArray(e)}let e8=(e,t)=>{if("number"!=typeof t||!Number.isInteger(t))throw new eL(`${e} must be an integer`);if(t<0)throw new eL(`${e} must be a positive integer`);return t},e5=e=>{try{return JSON.parse(e)}catch(e){return}},e9=e=>new Promise(t=>setTimeout(t,e)),e7="5.8.4",te=()=>"undefined"!=typeof window&&void 0!==window.document&&"undefined"!=typeof navigator,tt=()=>{let e="undefined"!=typeof Deno&&null!=Deno.build?"deno":"undefined"!=typeof EdgeRuntime?"edge":"[object process]"===Object.prototype.toString.call(void 0!==globalThis.process?globalThis.process:0)?"node":"unknown";if("deno"===e)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e7,"X-Stainless-OS":tr(Deno.build.os),"X-Stainless-Arch":ts(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:Deno.version?.deno??"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e7,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if("node"===e)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e7,"X-Stainless-OS":tr(globalThis.process.platform??"unknown"),"X-Stainless-Arch":ts(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};let t=function(){if("undefined"==typeof navigator||!navigator)return null;for(let{key:e,pattern:t}of[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}]){let s=t.exec(navigator.userAgent);if(s){let t=s[1]||0,r=s[2]||0,n=s[3]||0;return{browser:e,version:`${t}.${r}.${n}`}}}return null}();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e7,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e7,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}},ts=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?`other:${e}`:"unknown",tr=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?`Other:${e}`:"Unknown",tn=()=>r??(r=tt());function ti(...e){let t=globalThis.ReadableStream;if(void 0===t)throw Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new t(...e)}function ta(e){let t=Symbol.asyncIterator in e?e[Symbol.asyncIterator]():e[Symbol.iterator]();return ti({start(){},async pull(e){let{done:s,value:r}=await t.next();s?e.close():e.enqueue(r)},async cancel(){await t.return?.()}})}function to(e){if(e[Symbol.asyncIterator])return e;let t=e.getReader();return{async next(){try{let e=await t.read();return e?.done&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){let e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function tl(e){if(null===e||"object"!=typeof e)return;if(e[Symbol.asyncIterator])return void await e[Symbol.asyncIterator]().return?.();let t=e.getReader(),s=t.cancel();t.releaseLock(),await s}let tc=({headers:e,body:t})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(t)}),tu="RFC3986",th=e=>String(e),td={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:th},tf=(e,t)=>(tf=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty))(e,t),tp=(()=>{let e=[];for(let t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})();function tm(e,t){if(e3(e)){let s=[];for(let r=0;r<e.length;r+=1)s.push(t(e[r]));return s}return t(e)}let tg={brackets:e=>String(e)+"[]",comma:"comma",indices:(e,t)=>String(e)+"["+t+"]",repeat:e=>String(e)},tb=function(e,t){Array.prototype.push.apply(e,e3(t)?t:[t])},tw={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:(e,t,s,r,n)=>{if(0===e.length)return e;let i=e;if("symbol"==typeof e?i=Symbol.prototype.toString.call(e):"string"!=typeof e&&(i=String(e)),"iso-8859-1"===s)return escape(i).replace(/%u[0-9a-f]{4}/gi,function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"});let a="";for(let e=0;e<i.length;e+=1024){let t=i.length>=1024?i.slice(e,e+1024):i,s=[];for(let e=0;e<t.length;++e){let r=t.charCodeAt(e);if(45===r||46===r||95===r||126===r||r>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122||"RFC1738"===n&&(40===r||41===r)){s[s.length]=t.charAt(e);continue}if(r<128){s[s.length]=tp[r];continue}if(r<2048){s[s.length]=tp[192|r>>6]+tp[128|63&r];continue}if(r<55296||r>=57344){s[s.length]=tp[224|r>>12]+tp[128|r>>6&63]+tp[128|63&r];continue}e+=1,r=65536+((1023&r)<<10|1023&t.charCodeAt(e)),s[s.length]=tp[240|r>>18]+tp[128|r>>12&63]+tp[128|r>>6&63]+tp[128|63&r]}a+=s.join("")}return a},encodeValuesOnly:!1,format:tu,formatter:th,indices:!1,serializeDate:e=>(n??(n=Function.prototype.call.bind(Date.prototype.toISOString)))(e),skipNulls:!1,strictNullHandling:!1},ty={};function t_(e){let t;return(i??(i=(t=new globalThis.TextEncoder).encode.bind(t)))(e)}function tv(e){let t;return(a??(a=(t=new globalThis.TextDecoder).decode.bind(t)))(e)}class tx{constructor(){o.set(this,void 0),l.set(this,void 0),eN(this,o,new Uint8Array,"f"),eN(this,l,null,"f")}decode(e){let t;if(null==e)return[];let s=e instanceof ArrayBuffer?new Uint8Array(e):"string"==typeof e?t_(e):e;eN(this,o,function(e){let t=0;for(let s of e)t+=s.length;let s=new Uint8Array(t),r=0;for(let t of e)s.set(t,r),r+=t.length;return s}([eC(this,o,"f"),s]),"f");let r=[];for(;null!=(t=function(e,t){for(let s=t??0;s<e.length;s++){if(10===e[s])return{preceding:s,index:s+1,carriage:!1};if(13===e[s])return{preceding:s,index:s+1,carriage:!0}}return null}(eC(this,o,"f"),eC(this,l,"f")));){if(t.carriage&&null==eC(this,l,"f")){eN(this,l,t.index,"f");continue}if(null!=eC(this,l,"f")&&(t.index!==eC(this,l,"f")+1||t.carriage)){r.push(tv(eC(this,o,"f").subarray(0,eC(this,l,"f")-1))),eN(this,o,eC(this,o,"f").subarray(eC(this,l,"f")),"f"),eN(this,l,null,"f");continue}let e=null!==eC(this,l,"f")?t.preceding-1:t.preceding,s=tv(eC(this,o,"f").subarray(0,e));r.push(s),eN(this,o,eC(this,o,"f").subarray(t.index),"f"),eN(this,l,null,"f")}return r}flush(){return eC(this,o,"f").length?this.decode("\n"):[]}}o=new WeakMap,l=new WeakMap,tx.NEWLINE_CHARS=new Set(["\n","\r"]),tx.NEWLINE_REGEXP=/\r\n|[\n\r]/g;let tS={off:0,error:200,warn:300,info:400,debug:500},tk=(e,t,s)=>{if(e){if(Object.prototype.hasOwnProperty.call(tS,e))return e;tE(s).warn(`${t} was set to ${JSON.stringify(e)}, expected one of ${JSON.stringify(Object.keys(tS))}`)}};function tO(){}function tR(e,t,s){return!t||tS[e]>tS[s]?tO:t[e].bind(t)}let tA={error:tO,warn:tO,info:tO,debug:tO},t$=new WeakMap;function tE(e){let t=e.logger,s=e.logLevel??"off";if(!t)return tA;let r=t$.get(t);if(r&&r[0]===s)return r[1];let n={error:tR("error",t,s),warn:tR("warn",t,s),info:tR("info",t,s),debug:tR("debug",t,s)};return t$.set(t,[s,n]),n}let tI=e=>(e.options&&(e.options={...e.options},delete e.options.headers),e.headers&&(e.headers=Object.fromEntries((e.headers instanceof Headers?[...e.headers]:Object.entries(e.headers)).map(([e,t])=>[e,"authorization"===e.toLowerCase()||"cookie"===e.toLowerCase()||"set-cookie"===e.toLowerCase()?"***":t]))),"retryOfRequestLogID"in e&&(e.retryOfRequestLogID&&(e.retryOf=e.retryOfRequestLogID),delete e.retryOfRequestLogID),e);class tP{constructor(e,t,s){this.iterator=e,c.set(this,void 0),this.controller=t,eN(this,c,s,"f")}static fromSSEResponse(e,t,s){let r=!1,n=s?tE(s):console;async function*i(){if(r)throw new eL("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let s=!1;try{for await(let r of tT(e,t))if(!s){if(r.data.startsWith("[DONE]")){s=!0;continue}if(null===r.event||r.event.startsWith("response.")||r.event.startsWith("transcript.")){let t;try{t=JSON.parse(r.data)}catch(e){throw n.error("Could not parse message into JSON:",r.data),n.error("From chunk:",r.raw),e}if(t&&t.error)throw new eB(void 0,t.error,void 0,e.headers);yield t}else{let e;try{e=JSON.parse(r.data)}catch(e){throw console.error("Could not parse message into JSON:",r.data),console.error("From chunk:",r.raw),e}if("error"==r.event)throw new eB(void 0,e.error,e.message,void 0);yield{event:r.event,data:e}}}s=!0}catch(e){if(eq(e))return;throw e}finally{s||t.abort()}}return new tP(i,t,s)}static fromReadableStream(e,t,s){let r=!1;async function*n(){let t=new tx;for await(let s of to(e))for(let e of t.decode(s))yield e;for(let e of t.flush())yield e}return new tP(async function*(){if(r)throw new eL("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let e=!1;try{for await(let t of n())!e&&t&&(yield JSON.parse(t));e=!0}catch(e){if(eq(e))return;throw e}finally{e||t.abort()}},t,s)}[(c=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){let e=[],t=[],s=this.iterator(),r=r=>({next:()=>{if(0===r.length){let r=s.next();e.push(r),t.push(r)}return r.shift()}});return[new tP(()=>r(e),this.controller,eC(this,c,"f")),new tP(()=>r(t),this.controller,eC(this,c,"f"))]}toReadableStream(){let e,t=this;return ti({async start(){e=t[Symbol.asyncIterator]()},async pull(t){try{let{value:s,done:r}=await e.next();if(r)return t.close();let n=t_(JSON.stringify(s)+"\n");t.enqueue(n)}catch(e){t.error(e)}},async cancel(){await e.return?.()}})}}async function*tT(e,t){if(!e.body){if(t.abort(),void 0!==globalThis.navigator&&"ReactNative"===globalThis.navigator.product)throw new eL("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api");throw new eL("Attempted to iterate over a response with no body")}let s=new tN,r=new tx;for await(let t of tj(to(e.body)))for(let e of r.decode(t)){let t=s.decode(e);t&&(yield t)}for(let e of r.flush()){let t=s.decode(e);t&&(yield t)}}async function*tj(e){let t=new Uint8Array;for await(let s of e){let e;if(null==s)continue;let r=s instanceof ArrayBuffer?new Uint8Array(s):"string"==typeof s?t_(s):s,n=new Uint8Array(t.length+r.length);for(n.set(t),n.set(r,t.length),t=n;-1!==(e=function(e){for(let t=0;t<e.length-1;t++){if(10===e[t]&&10===e[t+1]||13===e[t]&&13===e[t+1])return t+2;if(13===e[t]&&10===e[t+1]&&t+3<e.length&&13===e[t+2]&&10===e[t+3])return t+4}return -1}(t));)yield t.slice(0,e),t=t.slice(e)}t.length>0&&(yield t)}class tN{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;let e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,s,r]=function(e,t){let s=e.indexOf(":");return -1!==s?[e.substring(0,s),t,e.substring(s+t.length)]:[e,"",""]}(e,":");return r.startsWith(" ")&&(r=r.substring(1)),"event"===t?this.event=r:"data"===t&&this.data.push(r),null}}async function tC(e,t){let{response:s,requestLogID:r,retryOfRequestLogID:n,startTime:i}=t,a=await (async()=>{if(t.options.stream)return(tE(e).debug("response",s.status,s.url,s.headers,s.body),t.options.__streamClass)?t.options.__streamClass.fromSSEResponse(s,t.controller,e):tP.fromSSEResponse(s,t.controller,e);if(204===s.status)return null;if(t.options.__binaryResponse)return s;let r=s.headers.get("content-type"),n=r?.split(";")[0]?.trim();return n?.includes("application/json")||n?.endsWith("+json")?tM(await s.json(),s):await s.text()})();return tE(e).debug(`[${r}] response parsed`,tI({retryOfRequestLogID:n,url:s.url,status:s.status,body:a,durationMs:Date.now()-i})),a}function tM(e,t){return!e||"object"!=typeof e||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}class tq extends Promise{constructor(e,t,s=tC){super(e=>{e(null)}),this.responsePromise=t,this.parseResponse=s,u.set(this,void 0),eN(this,u,e,"f")}_thenUnwrap(e){return new tq(eC(this,u,"f"),this.responsePromise,async(t,s)=>tM(e(await this.parseResponse(t,s),s),s.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){let[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(eC(this,u,"f"),e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}u=new WeakMap;class tD{constructor(e,t,s,r){h.set(this,void 0),eN(this,h,e,"f"),this.options=r,this.response=t,this.body=s}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageRequestOptions()}async getNextPage(){let e=this.nextPageRequestOptions();if(!e)throw new eL("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await eC(this,h,"f").requestAPIList(this.constructor,e)}async *iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async *[(h=new WeakMap,Symbol.asyncIterator)](){for await(let e of this.iterPages())for(let t of e.getPaginatedItems())yield t}}class tL extends tq{constructor(e,t,s){super(e,t,async(e,t)=>new s(e,t.response,await tC(e,t),t.options))}async *[Symbol.asyncIterator](){for await(let e of(await this))yield e}}class tB extends tD{constructor(e,t,s,r){super(e,t,s,r),this.data=s.data||[],this.object=s.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}}class tU extends tD{constructor(e,t,s,r){super(e,t,s,r),this.data=s.data||[],this.has_more=s.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return!1!==this.has_more&&super.hasNextPage()}nextPageRequestOptions(){var e;let t=this.getPaginatedItems(),s=t[t.length-1]?.id;return s?{...this.options,query:{..."object"!=typeof(e=this.options.query)?{}:e??{},after:s}}:null}}let tW=()=>{if("undefined"==typeof File){let{process:e}=globalThis;throw Error("`File` is not defined as a global, which is required for file uploads."+("string"==typeof e?.versions?.node&&20>parseInt(e.versions.node.split("."))?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function tF(e,t,s){return tW(),new File(e,t??"unknown_file",s)}function tX(e){return("object"==typeof e&&null!==e&&("name"in e&&e.name&&String(e.name)||"url"in e&&e.url&&String(e.url)||"filename"in e&&e.filename&&String(e.filename)||"path"in e&&e.path&&String(e.path))||"").split(/[\\/]/).pop()||void 0}let tH=e=>null!=e&&"object"==typeof e&&"function"==typeof e[Symbol.asyncIterator],tz=async(e,t)=>({...e,body:await tV(e.body,t)}),tJ=new WeakMap,tV=async(e,t)=>{if(!await function(e){let t="function"==typeof e?e:e.fetch,s=tJ.get(t);if(s)return s;let r=(async()=>{try{let e="Response"in t?t.Response:(await t("data:,")).constructor,s=new FormData;if(s.toString()===await new e(s).text())return!1;return!0}catch{return!0}})();return tJ.set(t,r),r}(t))throw TypeError("The provided fetch function does not support file uploads with the current global FormData class.");let s=new FormData;return await Promise.all(Object.entries(e||{}).map(([e,t])=>tY(s,e,t))),s},tK=e=>e instanceof Blob&&"name"in e,tG=e=>"object"==typeof e&&null!==e&&(e instanceof Response||tH(e)||tK(e)),tQ=e=>{if(tG(e))return!0;if(Array.isArray(e))return e.some(tQ);if(e&&"object"==typeof e){for(let t in e)if(tQ(e[t]))return!0}return!1},tY=async(e,t,s)=>{if(void 0!==s){if(null==s)throw TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if("string"==typeof s||"number"==typeof s||"boolean"==typeof s)e.append(t,String(s));else if(s instanceof Response)e.append(t,tF([await s.blob()],tX(s)));else if(tH(s))e.append(t,tF([await new Response(ta(s)).blob()],tX(s)));else if(tK(s))e.append(t,s,tX(s));else if(Array.isArray(s))await Promise.all(s.map(s=>tY(e,t+"[]",s)));else if("object"==typeof s)await Promise.all(Object.entries(s).map(([s,r])=>tY(e,`${t}[${s}]`,r)));else throw TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${s} instead`)}},tZ=e=>null!=e&&"object"==typeof e&&"number"==typeof e.size&&"string"==typeof e.type&&"function"==typeof e.text&&"function"==typeof e.slice&&"function"==typeof e.arrayBuffer,t0=e=>null!=e&&"object"==typeof e&&"string"==typeof e.name&&"number"==typeof e.lastModified&&tZ(e),t1=e=>null!=e&&"object"==typeof e&&"string"==typeof e.url&&"function"==typeof e.blob;async function t2(e,t,s){if(tW(),t0(e=await e))return e instanceof File?e:tF([await e.arrayBuffer()],e.name);if(t1(e)){let r=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()),tF(await t3(r),t,s)}let r=await t3(e);if(t||(t=tX(e)),!s?.type){let e=r.find(e=>"object"==typeof e&&"type"in e&&e.type);"string"==typeof e&&(s={...s,type:e})}return tF(r,t,s)}async function t3(e){let t=[];if("string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(tZ(e))t.push(e instanceof Blob?e:await e.arrayBuffer());else if(tH(e))for await(let s of e)t.push(...await t3(s));else{let t=e?.constructor?.name;throw Error(`Unexpected data type: ${typeof e}${t?`; constructor: ${t}`:""}${function(e){if("object"!=typeof e||null===e)return"";let t=Object.getOwnPropertyNames(e);return`; props: [${t.map(e=>`"${e}"`).join(", ")}]`}(e)}`)}return t}class t4{constructor(e){this._client=e}}function t6(e){return e.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}let t8=Object.freeze(Object.create(null)),t5=((e=t6)=>function(t,...s){let r;if(1===t.length)return t[0];let n=!1,i=[],a=t.reduce((t,r,a)=>{/[?#]/.test(r)&&(n=!0);let o=s[a],l=(n?encodeURIComponent:e)(""+o);return a!==s.length&&(null==o||"object"==typeof o&&o.toString===Object.getPrototypeOf(Object.getPrototypeOf(o.hasOwnProperty??t8)??t8)?.toString)&&(l=o+"",i.push({start:t.length+r.length,length:l.length,error:`Value of type ${Object.prototype.toString.call(o).slice(8,-1)} is not a valid path parameter`})),t+r+(a===s.length?"":l)},""),o=a.split(/[?#]/,1)[0],l=/(?<=^|\/)(?:\.|%2e){1,2}(?=\/|$)/gi;for(;null!==(r=l.exec(o));)i.push({start:r.index,length:r[0].length,error:`Value "${r[0]}" can't be safely passed as a path parameter`});if(i.sort((e,t)=>e.start-t.start),i.length>0){let e=0,t=i.reduce((t,s)=>{let r=" ".repeat(s.start-e),n="^".repeat(s.length);return e=s.start+s.length,t+r+n},"");throw new eL(`Path parameters result in path with invalid segments:
${i.map(e=>e.error).join("\n")}
${a}
${t}`)}return a})(t6);class t9 extends t4{list(e,t={},s){return this._client.getAPIList(t5`/chat/completions/${e}/messages`,tU,{query:t,...s})}}let t7=e=>e?.role==="assistant",se=e=>e?.role==="tool";class st{constructor(){d.add(this),this.controller=new AbortController,f.set(this,void 0),p.set(this,()=>{}),m.set(this,()=>{}),g.set(this,void 0),b.set(this,()=>{}),w.set(this,()=>{}),y.set(this,{}),_.set(this,!1),v.set(this,!1),x.set(this,!1),S.set(this,!1),eN(this,f,new Promise((e,t)=>{eN(this,p,e,"f"),eN(this,m,t,"f")}),"f"),eN(this,g,new Promise((e,t)=>{eN(this,b,e,"f"),eN(this,w,t,"f")}),"f"),eC(this,f,"f").catch(()=>{}),eC(this,g,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},eC(this,d,"m",k).bind(this))},0)}_connected(){this.ended||(eC(this,p,"f").call(this),this._emit("connect"))}get ended(){return eC(this,_,"f")}get errored(){return eC(this,v,"f")}get aborted(){return eC(this,x,"f")}abort(){this.controller.abort()}on(e,t){return(eC(this,y,"f")[e]||(eC(this,y,"f")[e]=[])).push({listener:t}),this}off(e,t){let s=eC(this,y,"f")[e];if(!s)return this;let r=s.findIndex(e=>e.listener===t);return r>=0&&s.splice(r,1),this}once(e,t){return(eC(this,y,"f")[e]||(eC(this,y,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,s)=>{eN(this,S,!0,"f"),"error"!==e&&this.once("error",s),this.once(e,t)})}async done(){eN(this,S,!0,"f"),await eC(this,g,"f")}_emit(e,...t){if(eC(this,_,"f"))return;"end"===e&&(eN(this,_,!0,"f"),eC(this,b,"f").call(this));let s=eC(this,y,"f")[e];if(s&&(eC(this,y,"f")[e]=s.filter(e=>!e.once),s.forEach(({listener:e})=>e(...t))),"abort"===e){let e=t[0];eC(this,S,"f")||s?.length||Promise.reject(e),eC(this,m,"f").call(this,e),eC(this,w,"f").call(this,e),this._emit("end");return}if("error"===e){let e=t[0];eC(this,S,"f")||s?.length||Promise.reject(e),eC(this,m,"f").call(this,e),eC(this,w,"f").call(this,e),this._emit("end")}}_emitFinal(){}}function ss(e){return e?.$brand==="auto-parseable-response-format"}function sr(e){return e?.$brand==="auto-parseable-tool"}function sn(e,t){let s=e.choices.map(e=>{var s,r;if("length"===e.finish_reason)throw new eY;if("content_filter"===e.finish_reason)throw new eZ;return{...e,message:{...e.message,...e.message.tool_calls?{tool_calls:e.message.tool_calls?.map(e=>(function(e,t){let s=e.tools?.find(e=>e.function?.name===t.function.name);return{...t,function:{...t.function,parsed_arguments:sr(s)?s.$parseRaw(t.function.arguments):s?.function.strict?JSON.parse(t.function.arguments):null}}})(t,e))??void 0}:void 0,parsed:e.message.content&&!e.message.refusal?(s=t,r=e.message.content,s.response_format?.type!=="json_schema"?null:s.response_format?.type==="json_schema"?"$parseRaw"in s.response_format?s.response_format.$parseRaw(r):JSON.parse(r):null):null}}});return{...e,choices:s}}function si(e){return!!ss(e.response_format)||(e.tools?.some(e=>sr(e)||"function"===e.type&&!0===e.function.strict)??!1)}f=new WeakMap,p=new WeakMap,m=new WeakMap,g=new WeakMap,b=new WeakMap,w=new WeakMap,y=new WeakMap,_=new WeakMap,v=new WeakMap,x=new WeakMap,S=new WeakMap,d=new WeakSet,k=function(e){if(eN(this,v,!0,"f"),e instanceof Error&&"AbortError"===e.name&&(e=new eU),e instanceof eU)return eN(this,x,!0,"f"),this._emit("abort",e);if(e instanceof eL)return this._emit("error",e);if(e instanceof Error){let t=new eL(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new eL(String(e)))};class sa extends st{constructor(){super(...arguments),O.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);let t=e.choices[0]?.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),se(e)&&e.content)this._emit("functionToolCallResult",e.content);else if(t7(e)&&e.tool_calls)for(let t of e.tool_calls)"function"===t.type&&this._emit("functionToolCall",t.function)}}async finalChatCompletion(){await this.done();let e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new eL("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),eC(this,O,"m",R).call(this)}async finalMessage(){return await this.done(),eC(this,O,"m",A).call(this)}async finalFunctionToolCall(){return await this.done(),eC(this,O,"m",$).call(this)}async finalFunctionToolCallResult(){return await this.done(),eC(this,O,"m",E).call(this)}async totalUsage(){return await this.done(),eC(this,O,"m",I).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){let e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);let t=eC(this,O,"m",A).call(this);t&&this._emit("finalMessage",t);let s=eC(this,O,"m",R).call(this);s&&this._emit("finalContent",s);let r=eC(this,O,"m",$).call(this);r&&this._emit("finalFunctionToolCall",r);let n=eC(this,O,"m",E).call(this);null!=n&&this._emit("finalFunctionToolCallResult",n),this._chatCompletions.some(e=>e.usage)&&this._emit("totalUsage",eC(this,O,"m",I).call(this))}async _createChatCompletion(e,t,s){let r=s?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),eC(this,O,"m",P).call(this,t);let n=await e.chat.completions.create({...t,stream:!1},{...s,signal:this.controller.signal});return this._connected(),this._addChatCompletion(sn(n,t))}async _runChatCompletion(e,t,s){for(let e of t.messages)this._addMessage(e,!1);return await this._createChatCompletion(e,t,s)}async _runTools(e,t,s){let r="tool",{tool_choice:n="auto",stream:i,...a}=t,o="string"!=typeof n&&n?.function?.name,{maxChatCompletions:l=10}=s||{},c=t.tools.map(e=>{if(sr(e)){if(!e.$callback)throw new eL("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:e.$callback,name:e.function.name,description:e.function.description||"",parameters:e.function.parameters,parse:e.$parseRaw,strict:!0}}}return e}),u={};for(let e of c)"function"===e.type&&(u[e.function.name||e.function.function.name]=e.function);let h="tools"in t?c.map(e=>"function"===e.type?{type:"function",function:{name:e.function.name||e.function.function.name,parameters:e.function.parameters,description:e.function.description,strict:e.function.strict}}:e):void 0;for(let e of t.messages)this._addMessage(e,!1);for(let t=0;t<l;++t){let t=await this._createChatCompletion(e,{...a,tool_choice:n,tools:h,messages:[...this.messages]},s),i=t.choices[0]?.message;if(!i)throw new eL("missing message in ChatCompletion response");if(!i.tool_calls?.length)break;for(let e of i.tool_calls){let t;if("function"!==e.type)continue;let s=e.id,{name:n,arguments:i}=e.function,a=u[n];if(a){if(o&&o!==n){let e=`Invalid tool_call: ${JSON.stringify(n)}. ${JSON.stringify(o)} requested. Please try again`;this._addMessage({role:r,tool_call_id:s,content:e});continue}}else{let e=`Invalid tool_call: ${JSON.stringify(n)}. Available options are: ${Object.keys(u).map(e=>JSON.stringify(e)).join(", ")}. Please try again`;this._addMessage({role:r,tool_call_id:s,content:e});continue}try{t="function"==typeof a.parse?await a.parse(i):i}catch(t){let e=t instanceof Error?t.message:String(t);this._addMessage({role:r,tool_call_id:s,content:e});continue}let l=await a.function(t,this),c=eC(this,O,"m",T).call(this,l);if(this._addMessage({role:r,tool_call_id:s,content:c}),o)return}}}}O=new WeakSet,R=function(){return eC(this,O,"m",A).call(this).content??null},A=function(){let e=this.messages.length;for(;e-- >0;){let t=this.messages[e];if(t7(t))return{...t,content:t.content??null,refusal:t.refusal??null}}throw new eL("stream ended without producing a ChatCompletionMessage with role=assistant")},$=function(){for(let e=this.messages.length-1;e>=0;e--){let t=this.messages[e];if(t7(t)&&t?.tool_calls?.length)return t.tool_calls.at(-1)?.function}},E=function(){for(let e=this.messages.length-1;e>=0;e--){let t=this.messages[e];if(se(t)&&null!=t.content&&"string"==typeof t.content&&this.messages.some(e=>"assistant"===e.role&&e.tool_calls?.some(e=>"function"===e.type&&e.id===t.tool_call_id)))return t.content}},I=function(){let e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(let{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},P=function(e){if(null!=e.n&&e.n>1)throw new eL("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},T=function(e){return"string"==typeof e?e:void 0===e?"undefined":JSON.stringify(e)};class so extends sa{static runTools(e,t,s){let r=new so,n={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run(()=>r._runTools(e,t,n)),r}_addMessage(e,t=!0){super._addMessage(e,t),t7(e)&&e.content&&this._emit("content",e.content)}}let sl={STR:1,NUM:2,ARR:4,OBJ:8,NULL:16,BOOL:32,NAN:64,INFINITY:128,MINUS_INFINITY:256,ALL:511};class sc extends Error{}class su extends Error{}let sh=(e,t)=>{let s=e.length,r=0,n=e=>{throw new sc(`${e} at position ${r}`)},i=e=>{throw new su(`${e} at position ${r}`)},a=()=>(h(),r>=s&&n("Unexpected end of input"),'"'===e[r])?o():"{"===e[r]?l():"["===e[r]?c():"null"===e.substring(r,r+4)||sl.NULL&t&&s-r<4&&"null".startsWith(e.substring(r))?(r+=4,null):"true"===e.substring(r,r+4)||sl.BOOL&t&&s-r<4&&"true".startsWith(e.substring(r))?(r+=4,!0):"false"===e.substring(r,r+5)||sl.BOOL&t&&s-r<5&&"false".startsWith(e.substring(r))?(r+=5,!1):"Infinity"===e.substring(r,r+8)||sl.INFINITY&t&&s-r<8&&"Infinity".startsWith(e.substring(r))?(r+=8,1/0):"-Infinity"===e.substring(r,r+9)||sl.MINUS_INFINITY&t&&1<s-r&&s-r<9&&"-Infinity".startsWith(e.substring(r))?(r+=9,-1/0):"NaN"===e.substring(r,r+3)||sl.NAN&t&&s-r<3&&"NaN".startsWith(e.substring(r))?(r+=3,NaN):u(),o=()=>{let a=r,o=!1;for(r++;r<s&&('"'!==e[r]||o&&"\\"===e[r-1]);)o="\\"===e[r]&&!o,r++;if('"'==e.charAt(r))try{return JSON.parse(e.substring(a,++r-Number(o)))}catch(e){i(String(e))}else if(sl.STR&t)try{return JSON.parse(e.substring(a,r-Number(o))+'"')}catch(t){return JSON.parse(e.substring(a,e.lastIndexOf("\\"))+'"')}n("Unterminated string literal")},l=()=>{r++,h();let i={};try{for(;"}"!==e[r];){if(h(),r>=s&&sl.OBJ&t)return i;let n=o();h(),r++;try{let e=a();Object.defineProperty(i,n,{value:e,writable:!0,enumerable:!0,configurable:!0})}catch(e){if(sl.OBJ&t)return i;throw e}h(),","===e[r]&&r++}}catch(e){if(sl.OBJ&t)return i;n("Expected '}' at end of object")}return r++,i},c=()=>{r++;let s=[];try{for(;"]"!==e[r];)s.push(a()),h(),","===e[r]&&r++}catch(e){if(sl.ARR&t)return s;n("Expected ']' at end of array")}return r++,s},u=()=>{if(0===r){"-"===e&&sl.NUM&t&&n("Not sure what '-' is");try{return JSON.parse(e)}catch(s){if(sl.NUM&t)try{if("."===e[e.length-1])return JSON.parse(e.substring(0,e.lastIndexOf(".")));return JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch(e){}i(String(s))}}let a=r;for("-"===e[r]&&r++;e[r]&&!",]}".includes(e[r]);)r++;r!=s||sl.NUM&t||n("Unterminated number literal");try{return JSON.parse(e.substring(a,r))}catch(s){"-"===e.substring(a,r)&&sl.NUM&t&&n("Not sure what '-' is");try{return JSON.parse(e.substring(a,e.lastIndexOf("e")))}catch(e){i(String(e))}}},h=()=>{for(;r<s&&" \n\r	".includes(e[r]);)r++};return a()},sd=e=>(function(e,t=sl.ALL){if("string"!=typeof e)throw TypeError(`expecting str, got ${typeof e}`);if(!e.trim())throw Error(`${e} is empty`);return sh(e.trim(),t)})(e,sl.ALL^sl.NUM);class sf extends sa{constructor(e){super(),j.add(this),N.set(this,void 0),C.set(this,void 0),M.set(this,void 0),eN(this,N,e,"f"),eN(this,C,[],"f")}get currentChatCompletionSnapshot(){return eC(this,M,"f")}static fromReadableStream(e){let t=new sf(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,s){let r=new sf(t);return r._run(()=>r._runChatCompletion(e,{...t,stream:!0},{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),r}async _createChatCompletion(e,t,s){super._createChatCompletion;let r=s?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),eC(this,j,"m",q).call(this);let n=await e.chat.completions.create({...t,stream:!0},{...s,signal:this.controller.signal});for await(let e of(this._connected(),n))eC(this,j,"m",L).call(this,e);if(n.controller.signal?.aborted)throw new eU;return this._addChatCompletion(eC(this,j,"m",W).call(this))}async _fromReadableStream(e,t){let s,r=t?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),eC(this,j,"m",q).call(this),this._connected();let n=tP.fromReadableStream(e,this.controller);for await(let e of n)s&&s!==e.id&&this._addChatCompletion(eC(this,j,"m",W).call(this)),eC(this,j,"m",L).call(this,e),s=e.id;if(n.controller.signal?.aborted)throw new eU;return this._addChatCompletion(eC(this,j,"m",W).call(this))}[(N=new WeakMap,C=new WeakMap,M=new WeakMap,j=new WeakSet,q=function(){this.ended||eN(this,M,void 0,"f")},D=function(e){let t=eC(this,C,"f")[e.index];return t||(t={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},eC(this,C,"f")[e.index]=t),t},L=function(e){if(this.ended)return;let t=eC(this,j,"m",X).call(this,e);for(let s of(this._emit("chunk",e,t),e.choices)){let e=t.choices[s.index];null!=s.delta.content&&e.message?.role==="assistant"&&e.message?.content&&(this._emit("content",s.delta.content,e.message.content),this._emit("content.delta",{delta:s.delta.content,snapshot:e.message.content,parsed:e.message.parsed})),null!=s.delta.refusal&&e.message?.role==="assistant"&&e.message?.refusal&&this._emit("refusal.delta",{delta:s.delta.refusal,snapshot:e.message.refusal}),s.logprobs?.content!=null&&e.message?.role==="assistant"&&this._emit("logprobs.content.delta",{content:s.logprobs?.content,snapshot:e.logprobs?.content??[]}),s.logprobs?.refusal!=null&&e.message?.role==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:s.logprobs?.refusal,snapshot:e.logprobs?.refusal??[]});let r=eC(this,j,"m",D).call(this,e);for(let t of(e.finish_reason&&(eC(this,j,"m",U).call(this,e),null!=r.current_tool_call_index&&eC(this,j,"m",B).call(this,e,r.current_tool_call_index)),s.delta.tool_calls??[]))r.current_tool_call_index!==t.index&&(eC(this,j,"m",U).call(this,e),null!=r.current_tool_call_index&&eC(this,j,"m",B).call(this,e,r.current_tool_call_index)),r.current_tool_call_index=t.index;for(let t of s.delta.tool_calls??[]){let s=e.message.tool_calls?.[t.index];s?.type&&(s?.type==="function"?this._emit("tool_calls.function.arguments.delta",{name:s.function?.name,index:t.index,arguments:s.function.arguments,parsed_arguments:s.function.parsed_arguments,arguments_delta:t.function?.arguments??""}):s?.type)}}},B=function(e,t){if(eC(this,j,"m",D).call(this,e).done_tool_calls.has(t))return;let s=e.message.tool_calls?.[t];if(!s)throw Error("no tool call snapshot");if(!s.type)throw Error("tool call snapshot missing `type`");if("function"===s.type){let e=eC(this,N,"f")?.tools?.find(e=>"function"===e.type&&e.function.name===s.function.name);this._emit("tool_calls.function.arguments.done",{name:s.function.name,index:t,arguments:s.function.arguments,parsed_arguments:sr(e)?e.$parseRaw(s.function.arguments):e?.function.strict?JSON.parse(s.function.arguments):null})}else s.type},U=function(e){let t=eC(this,j,"m",D).call(this,e);if(e.message.content&&!t.content_done){t.content_done=!0;let s=eC(this,j,"m",F).call(this);this._emit("content.done",{content:e.message.content,parsed:s?s.$parseRaw(e.message.content):null})}e.message.refusal&&!t.refusal_done&&(t.refusal_done=!0,this._emit("refusal.done",{refusal:e.message.refusal})),e.logprobs?.content&&!t.logprobs_content_done&&(t.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:e.logprobs.content})),e.logprobs?.refusal&&!t.logprobs_refusal_done&&(t.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:e.logprobs.refusal}))},W=function(){if(this.ended)throw new eL("stream has ended, this shouldn't happen");let e=eC(this,M,"f");if(!e)throw new eL("request ended without sending any chunks");return eN(this,M,void 0,"f"),eN(this,C,[],"f"),function(e,t){var s;let{id:r,choices:n,created:i,model:a,system_fingerprint:o,...l}=e;return s={...l,id:r,choices:n.map(({message:t,finish_reason:s,index:r,logprobs:n,...i})=>{if(!s)throw new eL(`missing finish_reason for choice ${r}`);let{content:a=null,function_call:o,tool_calls:l,...c}=t,u=t.role;if(!u)throw new eL(`missing role for choice ${r}`);if(o){let{arguments:e,name:l}=o;if(null==e)throw new eL(`missing function_call.arguments for choice ${r}`);if(!l)throw new eL(`missing function_call.name for choice ${r}`);return{...i,message:{content:a,function_call:{arguments:e,name:l},role:u,refusal:t.refusal??null},finish_reason:s,index:r,logprobs:n}}return l?{...i,index:r,finish_reason:s,logprobs:n,message:{...c,role:u,content:a,refusal:t.refusal??null,tool_calls:l.map((t,s)=>{let{function:n,type:i,id:a,...o}=t,{arguments:l,name:c,...u}=n||{};if(null==a)throw new eL(`missing choices[${r}].tool_calls[${s}].id
${sp(e)}`);if(null==i)throw new eL(`missing choices[${r}].tool_calls[${s}].type
${sp(e)}`);if(null==c)throw new eL(`missing choices[${r}].tool_calls[${s}].function.name
${sp(e)}`);if(null==l)throw new eL(`missing choices[${r}].tool_calls[${s}].function.arguments
${sp(e)}`);return{...o,id:a,type:i,function:{...u,name:c,arguments:l}}})}}:{...i,message:{...c,content:a,role:u,refusal:t.refusal??null},finish_reason:s,index:r,logprobs:n}}),created:i,model:a,object:"chat.completion",...o?{system_fingerprint:o}:{}},t&&si(t)?sn(s,t):{...s,choices:s.choices.map(e=>({...e,message:{...e.message,parsed:null,...e.message.tool_calls?{tool_calls:e.message.tool_calls}:void 0}}))}}(e,eC(this,N,"f"))},F=function(){let e=eC(this,N,"f")?.response_format;return ss(e)?e:null},X=function(e){var t,s,r,n;let i=eC(this,M,"f"),{choices:a,...o}=e;for(let{delta:a,finish_reason:l,index:c,logprobs:u=null,...h}of(i?Object.assign(i,o):i=eN(this,M,{...o,choices:[]},"f"),e.choices)){let e=i.choices[c];if(e||(e=i.choices[c]={finish_reason:l,index:c,message:{},logprobs:u,...h}),u)if(e.logprobs){let{content:r,refusal:n,...i}=u;Object.assign(e.logprobs,i),r&&((t=e.logprobs).content??(t.content=[]),e.logprobs.content.push(...r)),n&&((s=e.logprobs).refusal??(s.refusal=[]),e.logprobs.refusal.push(...n))}else e.logprobs=Object.assign({},u);if(l&&(e.finish_reason=l,eC(this,N,"f")&&si(eC(this,N,"f")))){if("length"===l)throw new eY;if("content_filter"===l)throw new eZ}if(Object.assign(e,h),!a)continue;let{content:o,refusal:d,function_call:f,role:p,tool_calls:m,...g}=a;if(Object.assign(e.message,g),d&&(e.message.refusal=(e.message.refusal||"")+d),p&&(e.message.role=p),f&&(e.message.function_call?(f.name&&(e.message.function_call.name=f.name),f.arguments&&((r=e.message.function_call).arguments??(r.arguments=""),e.message.function_call.arguments+=f.arguments)):e.message.function_call=f),o&&(e.message.content=(e.message.content||"")+o,!e.message.refusal&&eC(this,j,"m",F).call(this)&&(e.message.parsed=sd(e.message.content))),m)for(let{index:t,id:s,type:r,function:i,...a}of(e.message.tool_calls||(e.message.tool_calls=[]),m)){let o=(n=e.message.tool_calls)[t]??(n[t]={});Object.assign(o,a),s&&(o.id=s),r&&(o.type=r),i&&(o.function??(o.function={name:i.name??"",arguments:""})),i?.name&&(o.function.name=i.name),i?.arguments&&(o.function.arguments+=i.arguments,function(e,t){if(!e)return!1;let s=e.tools?.find(e=>e.function?.name===t.function.name);return sr(s)||s?.function.strict||!1}(eC(this,N,"f"),o)&&(o.function.parsed_arguments=sd(o.function.arguments)))}}return i},Symbol.asyncIterator)](){let e=[],t=[],s=!1;return this.on("chunk",s=>{let r=t.shift();r?r.resolve(s):e.push(s)}),this.on("end",()=>{for(let e of(s=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let r of(s=!0,t))r.reject(e);t.length=0}),this.on("error",e=>{for(let r of(s=!0,t))r.reject(e);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((e,s)=>t.push({resolve:e,reject:s})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new tP(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function sp(e){return JSON.stringify(e)}class sm extends sf{static fromReadableStream(e){let t=new sm(null);return t._run(()=>t._fromReadableStream(e)),t}static runTools(e,t,s){let r=new sm(t),n={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run(()=>r._runTools(e,t,n)),r}}class sg extends t4{constructor(){super(...arguments),this.messages=new t9(this._client)}create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}retrieve(e,t){return this._client.get(t5`/chat/completions/${e}`,t)}update(e,t,s){return this._client.post(t5`/chat/completions/${e}`,{body:t,...s})}list(e={},t){return this._client.getAPIList("/chat/completions",tU,{query:e,...t})}delete(e,t){return this._client.delete(t5`/chat/completions/${e}`,t)}parse(e,t){for(let t of e.tools??[]){if("function"!==t.type)throw new eL(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(!0!==t.function.strict)throw new eL(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}return this._client.chat.completions.create(e,{...t,headers:{...t?.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(t=>sn(t,e))}runTools(e,t){return e.stream?sm.runTools(this._client,e,t):so.runTools(this._client,e,t)}stream(e,t){return sf.createChatCompletion(this._client,e,t)}}sg.Messages=t9;class sb extends t4{constructor(){super(...arguments),this.completions=new sg(this._client)}}sb.Completions=sg;let sw=Symbol("brand.privateNullableHeaders"),sy=e=>{let t=new Headers,s=new Set;for(let r of e){let e=new Set;for(let[n,i]of function*(e){let t;if(!e)return;if(sw in e){let{values:t,nulls:s}=e;for(let e of(yield*t.entries(),s))yield[e,null];return}let s=!1;for(let r of(e instanceof Headers?t=e.entries():e4(e)?t=e:(s=!0,t=Object.entries(e??{})),t)){let e=r[0];if("string"!=typeof e)throw TypeError("expected header name to be a string");let t=e4(r[1])?r[1]:[r[1]],n=!1;for(let r of t)void 0!==r&&(s&&!n&&(n=!0,yield[e,null]),yield[e,r])}}(r)){let r=n.toLowerCase();e.has(r)||(t.delete(n),e.add(r)),null===i?(t.delete(n),s.add(r)):(t.append(n,i),s.delete(r))}}return{[sw]:!0,values:t,nulls:s}};class s_ extends t4{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:sy([{Accept:"application/octet-stream"},t?.headers]),__binaryResponse:!0})}}class sv extends t4{create(e,t){return this._client.post("/audio/transcriptions",tz({body:e,...t,stream:e.stream??!1,__metadata:{model:e.model}},this._client))}}class sx extends t4{create(e,t){return this._client.post("/audio/translations",tz({body:e,...t,__metadata:{model:e.model}},this._client))}}class sS extends t4{constructor(){super(...arguments),this.transcriptions=new sv(this._client),this.translations=new sx(this._client),this.speech=new s_(this._client)}}sS.Transcriptions=sv,sS.Translations=sx,sS.Speech=s_;class sk extends t4{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(t5`/batches/${e}`,t)}list(e={},t){return this._client.getAPIList("/batches",tU,{query:e,...t})}cancel(e,t){return this._client.post(t5`/batches/${e}/cancel`,t)}}class sO extends t4{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:sy([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}retrieve(e,t){return this._client.get(t5`/assistants/${e}`,{...t,headers:sy([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}update(e,t,s){return this._client.post(t5`/assistants/${e}`,{body:t,...s,headers:sy([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e={},t){return this._client.getAPIList("/assistants",tU,{query:e,...t,headers:sy([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}delete(e,t){return this._client.delete(t5`/assistants/${e}`,{...t,headers:sy([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}}class sR extends t4{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:sy([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}}class sA extends t4{create(e,t){return this._client.post("/realtime/transcription_sessions",{body:e,...t,headers:sy([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}}class s$ extends t4{constructor(){super(...arguments),this.sessions=new sR(this._client),this.transcriptionSessions=new sA(this._client)}}s$.Sessions=sR,s$.TranscriptionSessions=sA;class sE extends t4{create(e,t,s){return this._client.post(t5`/threads/${e}/messages`,{body:t,...s,headers:sy([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}retrieve(e,t,s){let{thread_id:r}=t;return this._client.get(t5`/threads/${r}/messages/${e}`,{...s,headers:sy([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}update(e,t,s){let{thread_id:r,...n}=t;return this._client.post(t5`/threads/${r}/messages/${e}`,{body:n,...s,headers:sy([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e,t={},s){return this._client.getAPIList(t5`/threads/${e}/messages`,tU,{query:t,...s,headers:sy([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}delete(e,t,s){let{thread_id:r}=t;return this._client.delete(t5`/threads/${r}/messages/${e}`,{...s,headers:sy([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}}class sI extends t4{retrieve(e,t,s){let{thread_id:r,run_id:n,...i}=t;return this._client.get(t5`/threads/${r}/runs/${n}/steps/${e}`,{query:i,...s,headers:sy([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e,t,s){let{thread_id:r,...n}=t;return this._client.getAPIList(t5`/threads/${r}/runs/${e}/steps`,tU,{query:n,...s,headers:sy([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}}let sP=e=>{if("undefined"!=typeof Buffer){let t=Buffer.from(e,"base64");return Array.from(new Float32Array(t.buffer,t.byteOffset,t.length/Float32Array.BYTES_PER_ELEMENT))}{let t=atob(e),s=t.length,r=new Uint8Array(s);for(let e=0;e<s;e++)r[e]=t.charCodeAt(e);return Array.from(new Float32Array(r.buffer))}},sT=e=>void 0!==globalThis.process?globalThis.process.env?.[e]?.trim()??void 0:void 0!==globalThis.Deno?globalThis.Deno.env?.get?.(e)?.trim():void 0;class sj extends st{constructor(){super(...arguments),H.add(this),J.set(this,[]),V.set(this,{}),K.set(this,{}),G.set(this,void 0),Q.set(this,void 0),Y.set(this,void 0),Z.set(this,void 0),ee.set(this,void 0),et.set(this,void 0),es.set(this,void 0),er.set(this,void 0),en.set(this,void 0)}[(J=new WeakMap,V=new WeakMap,K=new WeakMap,G=new WeakMap,Q=new WeakMap,Y=new WeakMap,Z=new WeakMap,ee=new WeakMap,et=new WeakMap,es=new WeakMap,er=new WeakMap,en=new WeakMap,H=new WeakSet,Symbol.asyncIterator)](){let e=[],t=[],s=!1;return this.on("event",s=>{let r=t.shift();r?r.resolve(s):e.push(s)}),this.on("end",()=>{for(let e of(s=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let r of(s=!0,t))r.reject(e);t.length=0}),this.on("error",e=>{for(let r of(s=!0,t))r.reject(e);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((e,s)=>t.push({resolve:e,reject:s})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){let t=new z;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){let s=t?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),this._connected();let r=tP.fromReadableStream(e,this.controller);for await(let e of r)eC(this,H,"m",ei).call(this,e);if(r.controller.signal?.aborted)throw new eU;return this._addRun(eC(this,H,"m",ea).call(this))}toReadableStream(){return new tP(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,s,r){let n=new z;return n._run(()=>n._runToolAssistantStream(e,t,s,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),n}async _createToolAssistantStream(e,t,s,r){let n=r?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort()));let i={...s,stream:!0},a=await e.submitToolOutputs(t,i,{...r,signal:this.controller.signal});for await(let e of(this._connected(),a))eC(this,H,"m",ei).call(this,e);if(a.controller.signal?.aborted)throw new eU;return this._addRun(eC(this,H,"m",ea).call(this))}static createThreadAssistantStream(e,t,s){let r=new z;return r._run(()=>r._threadAssistantStream(e,t,{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),r}static createAssistantStream(e,t,s,r){let n=new z;return n._run(()=>n._runAssistantStream(e,t,s,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),n}currentEvent(){return eC(this,es,"f")}currentRun(){return eC(this,er,"f")}currentMessageSnapshot(){return eC(this,G,"f")}currentRunStepSnapshot(){return eC(this,en,"f")}async finalRunSteps(){return await this.done(),Object.values(eC(this,V,"f"))}async finalMessages(){return await this.done(),Object.values(eC(this,K,"f"))}async finalRun(){if(await this.done(),!eC(this,Q,"f"))throw Error("Final run was not received.");return eC(this,Q,"f")}async _createThreadAssistantStream(e,t,s){let r=s?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort()));let n={...t,stream:!0},i=await e.createAndRun(n,{...s,signal:this.controller.signal});for await(let e of(this._connected(),i))eC(this,H,"m",ei).call(this,e);if(i.controller.signal?.aborted)throw new eU;return this._addRun(eC(this,H,"m",ea).call(this))}async _createAssistantStream(e,t,s,r){let n=r?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort()));let i={...s,stream:!0},a=await e.create(t,i,{...r,signal:this.controller.signal});for await(let e of(this._connected(),a))eC(this,H,"m",ei).call(this,e);if(a.controller.signal?.aborted)throw new eU;return this._addRun(eC(this,H,"m",ea).call(this))}static accumulateDelta(e,t){for(let[s,r]of Object.entries(t)){if(!e.hasOwnProperty(s)){e[s]=r;continue}let t=e[s];if(null==t||"index"===s||"type"===s){e[s]=r;continue}if("string"==typeof t&&"string"==typeof r)t+=r;else if("number"==typeof t&&"number"==typeof r)t+=r;else if(e6(t)&&e6(r))t=this.accumulateDelta(t,r);else if(Array.isArray(t)&&Array.isArray(r)){if(t.every(e=>"string"==typeof e||"number"==typeof e)){t.push(...r);continue}for(let e of r){if(!e6(e))throw Error(`Expected array delta entry to be an object but got: ${e}`);let s=e.index;if(null==s)throw console.error(e),Error("Expected array delta entry to have an `index` property");if("number"!=typeof s)throw Error(`Expected array delta entry \`index\` property to be a number but got ${s}`);let r=t[s];null==r?t.push(e):t[s]=this.accumulateDelta(r,e)}continue}else throw Error(`Unhandled record type: ${s}, deltaValue: ${r}, accValue: ${t}`);e[s]=t}return e}_addRun(e){return e}async _threadAssistantStream(e,t,s){return await this._createThreadAssistantStream(t,e,s)}async _runAssistantStream(e,t,s,r){return await this._createAssistantStream(t,e,s,r)}async _runToolAssistantStream(e,t,s,r){return await this._createToolAssistantStream(t,e,s,r)}}z=sj,ei=function(e){if(!this.ended)switch(eN(this,es,e,"f"),eC(this,H,"m",ec).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":eC(this,H,"m",ef).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":eC(this,H,"m",el).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":eC(this,H,"m",eo).call(this,e);break;case"error":throw Error("Encountered an error event in event processing - errors should be processed earlier")}},ea=function(){if(this.ended)throw new eL("stream has ended, this shouldn't happen");if(!eC(this,Q,"f"))throw Error("Final run has not been received");return eC(this,Q,"f")},eo=function(e){let[t,s]=eC(this,H,"m",eh).call(this,e,eC(this,G,"f"));for(let e of(eN(this,G,t,"f"),eC(this,K,"f")[t.id]=t,s)){let s=t.content[e.index];s?.type=="text"&&this._emit("textCreated",s.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(let s of e.data.delta.content){if("text"==s.type&&s.text){let e=s.text,r=t.content[s.index];if(r&&"text"==r.type)this._emit("textDelta",e,r.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=eC(this,Y,"f")){if(eC(this,Z,"f"))switch(eC(this,Z,"f").type){case"text":this._emit("textDone",eC(this,Z,"f").text,eC(this,G,"f"));break;case"image_file":this._emit("imageFileDone",eC(this,Z,"f").image_file,eC(this,G,"f"))}eN(this,Y,s.index,"f")}eN(this,Z,t.content[s.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(void 0!==eC(this,Y,"f")){let t=e.data.content[eC(this,Y,"f")];if(t)switch(t.type){case"image_file":this._emit("imageFileDone",t.image_file,eC(this,G,"f"));break;case"text":this._emit("textDone",t.text,eC(this,G,"f"))}}eC(this,G,"f")&&this._emit("messageDone",e.data),eN(this,G,void 0,"f")}},el=function(e){let t=eC(this,H,"m",eu).call(this,e);switch(eN(this,en,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":let s=e.data.delta;if(s.step_details&&"tool_calls"==s.step_details.type&&s.step_details.tool_calls&&"tool_calls"==t.step_details.type)for(let e of s.step_details.tool_calls)e.index==eC(this,ee,"f")?this._emit("toolCallDelta",e,t.step_details.tool_calls[e.index]):(eC(this,et,"f")&&this._emit("toolCallDone",eC(this,et,"f")),eN(this,ee,e.index,"f"),eN(this,et,t.step_details.tool_calls[e.index],"f"),eC(this,et,"f")&&this._emit("toolCallCreated",eC(this,et,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":eN(this,en,void 0,"f"),"tool_calls"==e.data.step_details.type&&eC(this,et,"f")&&(this._emit("toolCallDone",eC(this,et,"f")),eN(this,et,void 0,"f")),this._emit("runStepDone",e.data,t)}},ec=function(e){eC(this,J,"f").push(e),this._emit("event",e)},eu=function(e){switch(e.event){case"thread.run.step.created":return eC(this,V,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=eC(this,V,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let s=e.data;if(s.delta){let r=z.accumulateDelta(t,s.delta);eC(this,V,"f")[e.data.id]=r}return eC(this,V,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":eC(this,V,"f")[e.data.id]=e.data}if(eC(this,V,"f")[e.data.id])return eC(this,V,"f")[e.data.id];throw Error("No snapshot available")},eh=function(e,t){let s=[];switch(e.event){case"thread.message.created":return[e.data,s];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let r=e.data;if(r.delta.content)for(let e of r.delta.content)if(e.index in t.content){let s=t.content[e.index];t.content[e.index]=eC(this,H,"m",ed).call(this,e,s)}else t.content[e.index]=e,s.push(e);return[t,s];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,s];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},ed=function(e,t){return z.accumulateDelta(t,e)},ef=function(e){switch(eN(this,er,e.data,"f"),e.event){case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":eN(this,Q,e.data,"f"),eC(this,et,"f")&&(this._emit("toolCallDone",eC(this,et,"f")),eN(this,et,void 0,"f"))}};class sN extends t4{constructor(){super(...arguments),this.steps=new sI(this._client)}create(e,t,s){let{include:r,...n}=t;return this._client.post(t5`/threads/${e}/runs`,{query:{include:r},body:n,...s,headers:sy([{"OpenAI-Beta":"assistants=v2"},s?.headers]),stream:t.stream??!1})}retrieve(e,t,s){let{thread_id:r}=t;return this._client.get(t5`/threads/${r}/runs/${e}`,{...s,headers:sy([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}update(e,t,s){let{thread_id:r,...n}=t;return this._client.post(t5`/threads/${r}/runs/${e}`,{body:n,...s,headers:sy([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e,t={},s){return this._client.getAPIList(t5`/threads/${e}/runs`,tU,{query:t,...s,headers:sy([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}cancel(e,t,s){let{thread_id:r}=t;return this._client.post(t5`/threads/${r}/runs/${e}/cancel`,{...s,headers:sy([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}async createAndPoll(e,t,s){let r=await this.create(e,t,s);return await this.poll(r.id,{thread_id:e},s)}createAndStream(e,t,s){return sj.createAssistantStream(e,this._client.beta.threads.runs,t,s)}async poll(e,t,s){let r=sy([s?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":s?.pollIntervalMs?.toString()??void 0}]);for(;;){let{data:n,response:i}=await this.retrieve(e,t,{...s,headers:{...s?.headers,...r}}).withResponse();switch(n.status){case"queued":case"in_progress":case"cancelling":let a=5e3;if(s?.pollIntervalMs)a=s.pollIntervalMs;else{let e=i.headers.get("openai-poll-after-ms");if(e){let t=parseInt(e);isNaN(t)||(a=t)}}await e9(a);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return n}}}stream(e,t,s){return sj.createAssistantStream(e,this._client.beta.threads.runs,t,s)}submitToolOutputs(e,t,s){let{thread_id:r,...n}=t;return this._client.post(t5`/threads/${r}/runs/${e}/submit_tool_outputs`,{body:n,...s,headers:sy([{"OpenAI-Beta":"assistants=v2"},s?.headers]),stream:t.stream??!1})}async submitToolOutputsAndPoll(e,t,s){let r=await this.submitToolOutputs(e,t,s);return await this.poll(r.id,t,s)}submitToolOutputsStream(e,t,s){return sj.createToolAssistantStream(e,this._client.beta.threads.runs,t,s)}}sN.Steps=sI;class sC extends t4{constructor(){super(...arguments),this.runs=new sN(this._client),this.messages=new sE(this._client)}create(e={},t){return this._client.post("/threads",{body:e,...t,headers:sy([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}retrieve(e,t){return this._client.get(t5`/threads/${e}`,{...t,headers:sy([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}update(e,t,s){return this._client.post(t5`/threads/${e}`,{body:t,...s,headers:sy([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}delete(e,t){return this._client.delete(t5`/threads/${e}`,{...t,headers:sy([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:sy([{"OpenAI-Beta":"assistants=v2"},t?.headers]),stream:e.stream??!1})}async createAndRunPoll(e,t){let s=await this.createAndRun(e,t);return await this.runs.poll(s.id,{thread_id:s.thread_id},t)}createAndRunStream(e,t){return sj.createThreadAssistantStream(e,this._client.beta.threads,t)}}sC.Runs=sN,sC.Messages=sE;class sM extends t4{constructor(){super(...arguments),this.realtime=new s$(this._client),this.assistants=new sO(this._client),this.threads=new sC(this._client)}}sM.Realtime=s$,sM.Assistants=sO,sM.Threads=sC;class sq extends t4{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}class sD extends t4{retrieve(e,t,s){let{container_id:r}=t;return this._client.get(t5`/containers/${r}/files/${e}/content`,{...s,headers:sy([{Accept:"application/binary"},s?.headers]),__binaryResponse:!0})}}class sL extends t4{constructor(){super(...arguments),this.content=new sD(this._client)}create(e,t,s){return this._client.post(t5`/containers/${e}/files`,tz({body:t,...s},this._client))}retrieve(e,t,s){let{container_id:r}=t;return this._client.get(t5`/containers/${r}/files/${e}`,s)}list(e,t={},s){return this._client.getAPIList(t5`/containers/${e}/files`,tU,{query:t,...s})}delete(e,t,s){let{container_id:r}=t;return this._client.delete(t5`/containers/${r}/files/${e}`,{...s,headers:sy([{Accept:"*/*"},s?.headers])})}}sL.Content=sD;class sB extends t4{constructor(){super(...arguments),this.files=new sL(this._client)}create(e,t){return this._client.post("/containers",{body:e,...t})}retrieve(e,t){return this._client.get(t5`/containers/${e}`,t)}list(e={},t){return this._client.getAPIList("/containers",tU,{query:e,...t})}delete(e,t){return this._client.delete(t5`/containers/${e}`,{...t,headers:sy([{Accept:"*/*"},t?.headers])})}}sB.Files=sL;class sU extends t4{create(e,t){let s=!!e.encoding_format,r=s?e.encoding_format:"base64";s&&tE(this._client).debug("embeddings/user defined encoding_format:",e.encoding_format);let n=this._client.post("/embeddings",{body:{...e,encoding_format:r},...t});return s?n:(tE(this._client).debug("embeddings/decoding base64 embeddings from base64"),n._thenUnwrap(e=>(e&&e.data&&e.data.forEach(e=>{let t=e.embedding;e.embedding=sP(t)}),e)))}}class sW extends t4{retrieve(e,t,s){let{eval_id:r,run_id:n}=t;return this._client.get(t5`/evals/${r}/runs/${n}/output_items/${e}`,s)}list(e,t,s){let{eval_id:r,...n}=t;return this._client.getAPIList(t5`/evals/${r}/runs/${e}/output_items`,tU,{query:n,...s})}}class sF extends t4{constructor(){super(...arguments),this.outputItems=new sW(this._client)}create(e,t,s){return this._client.post(t5`/evals/${e}/runs`,{body:t,...s})}retrieve(e,t,s){let{eval_id:r}=t;return this._client.get(t5`/evals/${r}/runs/${e}`,s)}list(e,t={},s){return this._client.getAPIList(t5`/evals/${e}/runs`,tU,{query:t,...s})}delete(e,t,s){let{eval_id:r}=t;return this._client.delete(t5`/evals/${r}/runs/${e}`,s)}cancel(e,t,s){let{eval_id:r}=t;return this._client.post(t5`/evals/${r}/runs/${e}`,s)}}sF.OutputItems=sW;class sX extends t4{constructor(){super(...arguments),this.runs=new sF(this._client)}create(e,t){return this._client.post("/evals",{body:e,...t})}retrieve(e,t){return this._client.get(t5`/evals/${e}`,t)}update(e,t,s){return this._client.post(t5`/evals/${e}`,{body:t,...s})}list(e={},t){return this._client.getAPIList("/evals",tU,{query:e,...t})}delete(e,t){return this._client.delete(t5`/evals/${e}`,t)}}sX.Runs=sF;class sH extends t4{create(e,t){return this._client.post("/files",tz({body:e,...t},this._client))}retrieve(e,t){return this._client.get(t5`/files/${e}`,t)}list(e={},t){return this._client.getAPIList("/files",tU,{query:e,...t})}delete(e,t){return this._client.delete(t5`/files/${e}`,t)}content(e,t){return this._client.get(t5`/files/${e}/content`,{...t,headers:sy([{Accept:"application/binary"},t?.headers]),__binaryResponse:!0})}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:s=18e5}={}){let r=new Set(["processed","error","deleted"]),n=Date.now(),i=await this.retrieve(e);for(;!i.status||!r.has(i.status);)if(await e9(t),i=await this.retrieve(e),Date.now()-n>s)throw new eF({message:`Giving up on waiting for file ${e} to finish processing after ${s} milliseconds.`});return i}}class sz extends t4{}class sJ extends t4{run(e,t){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...t})}validate(e,t){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...t})}}class sV extends t4{constructor(){super(...arguments),this.graders=new sJ(this._client)}}sV.Graders=sJ;class sK extends t4{create(e,t,s){return this._client.getAPIList(t5`/fine_tuning/checkpoints/${e}/permissions`,tB,{body:t,method:"post",...s})}retrieve(e,t={},s){return this._client.get(t5`/fine_tuning/checkpoints/${e}/permissions`,{query:t,...s})}delete(e,t,s){let{fine_tuned_model_checkpoint:r}=t;return this._client.delete(t5`/fine_tuning/checkpoints/${r}/permissions/${e}`,s)}}class sG extends t4{constructor(){super(...arguments),this.permissions=new sK(this._client)}}sG.Permissions=sK;class sQ extends t4{list(e,t={},s){return this._client.getAPIList(t5`/fine_tuning/jobs/${e}/checkpoints`,tU,{query:t,...s})}}class sY extends t4{constructor(){super(...arguments),this.checkpoints=new sQ(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(t5`/fine_tuning/jobs/${e}`,t)}list(e={},t){return this._client.getAPIList("/fine_tuning/jobs",tU,{query:e,...t})}cancel(e,t){return this._client.post(t5`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},s){return this._client.getAPIList(t5`/fine_tuning/jobs/${e}/events`,tU,{query:t,...s})}pause(e,t){return this._client.post(t5`/fine_tuning/jobs/${e}/pause`,t)}resume(e,t){return this._client.post(t5`/fine_tuning/jobs/${e}/resume`,t)}}sY.Checkpoints=sQ;class sZ extends t4{constructor(){super(...arguments),this.methods=new sz(this._client),this.jobs=new sY(this._client),this.checkpoints=new sG(this._client),this.alpha=new sV(this._client)}}sZ.Methods=sz,sZ.Jobs=sY,sZ.Checkpoints=sG,sZ.Alpha=sV;class s0 extends t4{}class s1 extends t4{constructor(){super(...arguments),this.graderModels=new s0(this._client)}}s1.GraderModels=s0;class s2 extends t4{createVariation(e,t){return this._client.post("/images/variations",tz({body:e,...t},this._client))}edit(e,t){return this._client.post("/images/edits",tz({body:e,...t},this._client))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}class s3 extends t4{retrieve(e,t){return this._client.get(t5`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",tB,e)}delete(e,t){return this._client.delete(t5`/models/${e}`,t)}}class s4 extends t4{create(e,t){return this._client.post("/moderations",{body:e,...t})}}function s6(e,t){let s=e.output.map(e=>{if("function_call"===e.type)return{...e,parsed_arguments:function(e,t){let s=function(e,t){return e.find(e=>"function"===e.type&&e.name===t)}(e.tools??[],t.name);return{...t,...t,parsed_arguments:function(e){return e?.$brand==="auto-parseable-tool"}(s)?s.$parseRaw(t.arguments):s?.strict?JSON.parse(t.arguments):null}}(t,e)};if("message"===e.type){let s=e.content.map(e=>{var s,r;return"output_text"===e.type?{...e,parsed:(s=t,r=e.text,s.text?.format?.type!=="json_schema"?null:"$parseRaw"in s.text?.format?(s.text?.format).$parseRaw(r):JSON.parse(r))}:e});return{...e,content:s}}return e}),r=Object.assign({},e,{output:s});return Object.getOwnPropertyDescriptor(e,"output_text")||s8(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get(){for(let e of r.output)if("message"===e.type){for(let t of e.content)if("output_text"===t.type&&null!==t.parsed)return t.parsed}return null}}),r}function s8(e){let t=[];for(let s of e.output)if("message"===s.type)for(let e of s.content)"output_text"===e.type&&t.push(e.text);e.output_text=t.join("")}class s5 extends st{constructor(e){super(),ep.add(this),em.set(this,void 0),eg.set(this,void 0),eb.set(this,void 0),eN(this,em,e,"f")}static createResponse(e,t,s){let r=new s5(t);return r._run(()=>r._createOrRetrieveResponse(e,t,{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),r}async _createOrRetrieveResponse(e,t,s){let r,n=s?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),eC(this,ep,"m",ew).call(this);let i=null;for await(let n of("response_id"in t?(r=await e.responses.retrieve(t.response_id,{stream:!0},{...s,signal:this.controller.signal,stream:!0}),i=t.starting_after??null):r=await e.responses.create({...t,stream:!0},{...s,signal:this.controller.signal}),this._connected(),r))eC(this,ep,"m",ey).call(this,n,i);if(r.controller.signal?.aborted)throw new eU;return eC(this,ep,"m",e_).call(this)}[(em=new WeakMap,eg=new WeakMap,eb=new WeakMap,ep=new WeakSet,ew=function(){this.ended||eN(this,eg,void 0,"f")},ey=function(e,t){if(this.ended)return;let s=(e,s)=>{(null==t||s.sequence_number>t)&&this._emit(e,s)},r=eC(this,ep,"m",ev).call(this,e);switch(s("event",e),e.type){case"response.output_text.delta":{let t=r.output[e.output_index];if(!t)throw new eL(`missing output at index ${e.output_index}`);if("message"===t.type){let r=t.content[e.content_index];if(!r)throw new eL(`missing content at index ${e.content_index}`);if("output_text"!==r.type)throw new eL(`expected content to be 'output_text', got ${r.type}`);s("response.output_text.delta",{...e,snapshot:r.text})}break}case"response.function_call_arguments.delta":{let t=r.output[e.output_index];if(!t)throw new eL(`missing output at index ${e.output_index}`);"function_call"===t.type&&s("response.function_call_arguments.delta",{...e,snapshot:t.arguments});break}default:s(e.type,e)}},e_=function(){if(this.ended)throw new eL("stream has ended, this shouldn't happen");let e=eC(this,eg,"f");if(!e)throw new eL("request ended without sending any events");eN(this,eg,void 0,"f");let t=function(e,t){var s;return t&&(s=t,ss(s.text?.format))?s6(e,t):{...e,output_parsed:null,output:e.output.map(e=>"function_call"===e.type?{...e,parsed_arguments:null}:"message"===e.type?{...e,content:e.content.map(e=>({...e,parsed:null}))}:e)}}(e,eC(this,em,"f"));return eN(this,eb,t,"f"),t},ev=function(e){let t=eC(this,eg,"f");if(!t){if("response.created"!==e.type)throw new eL(`When snapshot hasn't been set yet, expected 'response.created' event, got ${e.type}`);return eN(this,eg,e.response,"f")}switch(e.type){case"response.output_item.added":t.output.push(e.item);break;case"response.content_part.added":{let s=t.output[e.output_index];if(!s)throw new eL(`missing output at index ${e.output_index}`);"message"===s.type&&s.content.push(e.part);break}case"response.output_text.delta":{let s=t.output[e.output_index];if(!s)throw new eL(`missing output at index ${e.output_index}`);if("message"===s.type){let t=s.content[e.content_index];if(!t)throw new eL(`missing content at index ${e.content_index}`);if("output_text"!==t.type)throw new eL(`expected content to be 'output_text', got ${t.type}`);t.text+=e.delta}break}case"response.function_call_arguments.delta":{let s=t.output[e.output_index];if(!s)throw new eL(`missing output at index ${e.output_index}`);"function_call"===s.type&&(s.arguments+=e.delta);break}case"response.completed":eN(this,eg,e.response,"f")}return t},Symbol.asyncIterator)](){let e=[],t=[],s=!1;return this.on("event",s=>{let r=t.shift();r?r.resolve(s):e.push(s)}),this.on("end",()=>{for(let e of(s=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let r of(s=!0,t))r.reject(e);t.length=0}),this.on("error",e=>{for(let r of(s=!0,t))r.reject(e);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((e,s)=>t.push({resolve:e,reject:s})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();let e=eC(this,eb,"f");if(!e)throw new eL("stream ended without producing a ChatCompletion");return e}}class s9 extends t4{list(e,t={},s){return this._client.getAPIList(t5`/responses/${e}/input_items`,tU,{query:t,...s})}}class s7 extends t4{constructor(){super(...arguments),this.inputItems=new s9(this._client)}create(e,t){return this._client.post("/responses",{body:e,...t,stream:e.stream??!1})._thenUnwrap(e=>("object"in e&&"response"===e.object&&s8(e),e))}retrieve(e,t={},s){return this._client.get(t5`/responses/${e}`,{query:t,...s,stream:t?.stream??!1})._thenUnwrap(e=>("object"in e&&"response"===e.object&&s8(e),e))}delete(e,t){return this._client.delete(t5`/responses/${e}`,{...t,headers:sy([{Accept:"*/*"},t?.headers])})}parse(e,t){return this._client.responses.create(e,t)._thenUnwrap(t=>s6(t,e))}stream(e,t){return s5.createResponse(this._client,e,t)}cancel(e,t){return this._client.post(t5`/responses/${e}/cancel`,t)}}s7.InputItems=s9;class re extends t4{create(e,t,s){return this._client.post(t5`/uploads/${e}/parts`,tz({body:t,...s},this._client))}}class rt extends t4{constructor(){super(...arguments),this.parts=new re(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(t5`/uploads/${e}/cancel`,t)}complete(e,t,s){return this._client.post(t5`/uploads/${e}/complete`,{body:t,...s})}}rt.Parts=re;let rs=async e=>{let t=await Promise.allSettled(e),s=t.filter(e=>"rejected"===e.status);if(s.length){for(let e of s)console.error(e.reason);throw Error(`${s.length} promise(s) failed - see the above errors`)}let r=[];for(let e of t)"fulfilled"===e.status&&r.push(e.value);return r};class rr extends t4{create(e,t,s){return this._client.post(t5`/vector_stores/${e}/file_batches`,{body:t,...s,headers:sy([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}retrieve(e,t,s){let{vector_store_id:r}=t;return this._client.get(t5`/vector_stores/${r}/file_batches/${e}`,{...s,headers:sy([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}cancel(e,t,s){let{vector_store_id:r}=t;return this._client.post(t5`/vector_stores/${r}/file_batches/${e}/cancel`,{...s,headers:sy([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}async createAndPoll(e,t,s){let r=await this.create(e,t);return await this.poll(e,r.id,s)}listFiles(e,t,s){let{vector_store_id:r,...n}=t;return this._client.getAPIList(t5`/vector_stores/${r}/file_batches/${e}/files`,tU,{query:n,...s,headers:sy([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}async poll(e,t,s){let r=sy([s?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":s?.pollIntervalMs?.toString()??void 0}]);for(;;){let{data:n,response:i}=await this.retrieve(t,{vector_store_id:e},{...s,headers:r}).withResponse();switch(n.status){case"in_progress":let a=5e3;if(s?.pollIntervalMs)a=s.pollIntervalMs;else{let e=i.headers.get("openai-poll-after-ms");if(e){let t=parseInt(e);isNaN(t)||(a=t)}}await e9(a);break;case"failed":case"cancelled":case"completed":return n}}}async uploadAndPoll(e,{files:t,fileIds:s=[]},r){if(null==t||0==t.length)throw Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");let n=Math.min(r?.maxConcurrency??5,t.length),i=this._client,a=t.values(),o=[...s];async function l(e){for(let t of e){let e=await i.files.create({file:t,purpose:"assistants"},r);o.push(e.id)}}let c=Array(n).fill(a).map(l);return await rs(c),await this.createAndPoll(e,{file_ids:o})}}class rn extends t4{create(e,t,s){return this._client.post(t5`/vector_stores/${e}/files`,{body:t,...s,headers:sy([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}retrieve(e,t,s){let{vector_store_id:r}=t;return this._client.get(t5`/vector_stores/${r}/files/${e}`,{...s,headers:sy([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}update(e,t,s){let{vector_store_id:r,...n}=t;return this._client.post(t5`/vector_stores/${r}/files/${e}`,{body:n,...s,headers:sy([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e,t={},s){return this._client.getAPIList(t5`/vector_stores/${e}/files`,tU,{query:t,...s,headers:sy([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}delete(e,t,s){let{vector_store_id:r}=t;return this._client.delete(t5`/vector_stores/${r}/files/${e}`,{...s,headers:sy([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}async createAndPoll(e,t,s){let r=await this.create(e,t,s);return await this.poll(e,r.id,s)}async poll(e,t,s){let r=sy([s?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":s?.pollIntervalMs?.toString()??void 0}]);for(;;){let n=await this.retrieve(t,{vector_store_id:e},{...s,headers:r}).withResponse(),i=n.data;switch(i.status){case"in_progress":let a=5e3;if(s?.pollIntervalMs)a=s.pollIntervalMs;else{let e=n.response.headers.get("openai-poll-after-ms");if(e){let t=parseInt(e);isNaN(t)||(a=t)}}await e9(a);break;case"failed":case"completed":return i}}}async upload(e,t,s){let r=await this._client.files.create({file:t,purpose:"assistants"},s);return this.create(e,{file_id:r.id},s)}async uploadAndPoll(e,t,s){let r=await this.upload(e,t,s);return await this.poll(e,r.id,s)}content(e,t,s){let{vector_store_id:r}=t;return this._client.getAPIList(t5`/vector_stores/${r}/files/${e}/content`,tB,{...s,headers:sy([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}}class ri extends t4{constructor(){super(...arguments),this.files=new rn(this._client),this.fileBatches=new rr(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:sy([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}retrieve(e,t){return this._client.get(t5`/vector_stores/${e}`,{...t,headers:sy([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}update(e,t,s){return this._client.post(t5`/vector_stores/${e}`,{body:t,...s,headers:sy([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(e={},t){return this._client.getAPIList("/vector_stores",tU,{query:e,...t,headers:sy([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}delete(e,t){return this._client.delete(t5`/vector_stores/${e}`,{...t,headers:sy([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}search(e,t,s){return this._client.getAPIList(t5`/vector_stores/${e}/search`,tB,{body:t,method:"post",...s,headers:sy([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}}ri.Files=rn,ri.FileBatches=rr;class ra extends t4{constructor(){super(...arguments),ex.add(this)}async unwrap(e,t,s=this._client.webhookSecret,r=300){return await this.verifySignature(e,t,s,r),JSON.parse(e)}async verifySignature(e,t,s=this._client.webhookSecret,r=300){if("undefined"==typeof crypto||"function"!=typeof crypto.subtle.importKey||"function"!=typeof crypto.subtle.verify)throw Error("Webhook signature verification is only supported when the `crypto` global is defined");eC(this,ex,"m",eS).call(this,s);let n=sy([t]).values,i=eC(this,ex,"m",ek).call(this,n,"webhook-signature"),a=eC(this,ex,"m",ek).call(this,n,"webhook-timestamp"),o=eC(this,ex,"m",ek).call(this,n,"webhook-id"),l=parseInt(a,10);if(isNaN(l))throw new e0("Invalid webhook timestamp format");let c=Math.floor(Date.now()/1e3);if(c-l>r)throw new e0("Webhook timestamp is too old");if(l>c+r)throw new e0("Webhook timestamp is too new");let u=i.split(" ").map(e=>e.startsWith("v1,")?e.substring(3):e),h=s.startsWith("whsec_")?Buffer.from(s.replace("whsec_",""),"base64"):Buffer.from(s,"utf-8"),d=o?`${o}.${a}.${e}`:`${a}.${e}`,f=await crypto.subtle.importKey("raw",h,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(let e of u)try{let t=Buffer.from(e,"base64");if(await crypto.subtle.verify("HMAC",f,t,new TextEncoder().encode(d)))return}catch{continue}throw new e0("The given webhook signature does not match the expected signature")}}ex=new WeakSet,eS=function(e){if("string"!=typeof e||0===e.length)throw Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},ek=function(e,t){if(!e)throw Error("Headers are required");let s=e.get(t);if(null==s)throw Error(`Missing required header: ${t}`);return s};class ro{constructor({baseURL:e=sT("OPENAI_BASE_URL"),apiKey:t=sT("OPENAI_API_KEY"),organization:s=sT("OPENAI_ORG_ID")??null,project:r=sT("OPENAI_PROJECT_ID")??null,webhookSecret:n=sT("OPENAI_WEBHOOK_SECRET")??null,...i}={}){if(eO.add(this),eA.set(this,void 0),this.completions=new sq(this),this.chat=new sb(this),this.embeddings=new sU(this),this.files=new sH(this),this.images=new s2(this),this.audio=new sS(this),this.moderations=new s4(this),this.models=new s3(this),this.fineTuning=new sZ(this),this.graders=new s1(this),this.vectorStores=new ri(this),this.webhooks=new ra(this),this.beta=new sM(this),this.batches=new sk(this),this.uploads=new rt(this),this.responses=new s7(this),this.evals=new sX(this),this.containers=new sB(this),void 0===t)throw new eL("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");let a={apiKey:t,organization:s,project:r,webhookSecret:n,...i,baseURL:e||"https://api.openai.com/v1"};if(!a.dangerouslyAllowBrowser&&te())throw new eL("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");this.baseURL=a.baseURL,this.timeout=a.timeout??eR.DEFAULT_TIMEOUT,this.logger=a.logger??console;let o="warn";this.logLevel=o,this.logLevel=tk(a.logLevel,"ClientOptions.logLevel",this)??tk(sT("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??o,this.fetchOptions=a.fetchOptions,this.maxRetries=a.maxRetries??2,this.fetch=a.fetch??function(){if("undefined"!=typeof fetch)return fetch;throw Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}(),eN(this,eA,tc,"f"),this._options=a,this.apiKey=t,this.organization=s,this.project=r,this.webhookSecret=n}withOptions(e){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){}async authHeaders(e){return sy([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(e){return function(e,t={}){let s,r,n=e,i=function(e=tw){let t;if(void 0!==e.allowEmptyArrays&&"boolean"!=typeof e.allowEmptyArrays)throw TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==e.encodeDotInKeys&&"boolean"!=typeof e.encodeDotInKeys)throw TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw TypeError("Encoder has to be a function.");let s=e.charset||tw.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let r=tu;if(void 0!==e.format){if(!tf(td,e.format))throw TypeError("Unknown format option provided.");r=e.format}let n=td[r],i=tw.filter;if(("function"==typeof e.filter||e3(e.filter))&&(i=e.filter),t=e.arrayFormat&&e.arrayFormat in tg?e.arrayFormat:"indices"in e?e.indices?"indices":"repeat":tw.arrayFormat,"commaRoundTrip"in e&&"boolean"!=typeof e.commaRoundTrip)throw TypeError("`commaRoundTrip` must be a boolean, or absent");let a=void 0===e.allowDots?!0==!!e.encodeDotInKeys||tw.allowDots:!!e.allowDots;return{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:tw.addQueryPrefix,allowDots:a,allowEmptyArrays:"boolean"==typeof e.allowEmptyArrays?!!e.allowEmptyArrays:tw.allowEmptyArrays,arrayFormat:t,charset:s,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:tw.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:void 0===e.delimiter?tw.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:tw.encode,encodeDotInKeys:"boolean"==typeof e.encodeDotInKeys?e.encodeDotInKeys:tw.encodeDotInKeys,encoder:"function"==typeof e.encoder?e.encoder:tw.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:tw.encodeValuesOnly,filter:i,format:r,formatter:n,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:tw.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:tw.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:tw.strictNullHandling}}(t);"function"==typeof i.filter?n=(0,i.filter)("",n):e3(i.filter)&&(s=i.filter);let a=[];if("object"!=typeof n||null===n)return"";let o=tg[i.arrayFormat],l="comma"===o&&i.commaRoundTrip;s||(s=Object.keys(n)),i.sort&&s.sort(i.sort);let c=new WeakMap;for(let e=0;e<s.length;++e){let t=s[e];i.skipNulls&&null===n[t]||tb(a,function e(t,s,r,n,i,a,o,l,c,u,h,d,f,p,m,g,b,w){var y,_;let v,x=t,S=w,k=0,O=!1;for(;void 0!==(S=S.get(ty))&&!O;){let e=S.get(t);if(k+=1,void 0!==e)if(e===k)throw RangeError("Cyclic object value");else O=!0;void 0===S.get(ty)&&(k=0)}if("function"==typeof u?x=u(s,x):x instanceof Date?x=f?.(x):"comma"===r&&e3(x)&&(x=tm(x,function(e){return e instanceof Date?f?.(e):e})),null===x){if(a)return c&&!g?c(s,tw.encoder,b,"key",p):s;x=""}if("string"==typeof(y=x)||"number"==typeof y||"boolean"==typeof y||"symbol"==typeof y||"bigint"==typeof y||(_=x)&&"object"==typeof _&&_.constructor&&_.constructor.isBuffer&&_.constructor.isBuffer(_)){if(c){let e=g?s:c(s,tw.encoder,b,"key",p);return[m?.(e)+"="+m?.(c(x,tw.encoder,b,"value",p))]}return[m?.(s)+"="+m?.(String(x))]}let R=[];if(void 0===x)return R;if("comma"===r&&e3(x))g&&c&&(x=tm(x,c)),v=[{value:x.length>0?x.join(",")||null:void 0}];else if(e3(u))v=u;else{let e=Object.keys(x);v=h?e.sort(h):e}let A=l?String(s).replace(/\./g,"%2E"):String(s),$=n&&e3(x)&&1===x.length?A+"[]":A;if(i&&e3(x)&&0===x.length)return $+"[]";for(let s=0;s<v.length;++s){let y=v[s],_="object"==typeof y&&void 0!==y.value?y.value:x[y];if(o&&null===_)continue;let S=d&&l?y.replace(/\./g,"%2E"):y,O=e3(x)?"function"==typeof r?r($,S):$:$+(d?"."+S:"["+S+"]");w.set(t,k);let A=new WeakMap;A.set(ty,w),tb(R,e(_,O,r,n,i,a,o,l,"comma"===r&&g&&e3(x)?null:c,u,h,d,f,p,m,g,b,A))}return R}(n[t],t,o,l,i.allowEmptyArrays,i.strictNullHandling,i.skipNulls,i.encodeDotInKeys,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.format,i.formatter,i.encodeValuesOnly,i.charset,c))}let u=a.join(i.delimiter),h=!0===i.addQueryPrefix?"?":"";return i.charsetSentinel&&("iso-8859-1"===i.charset?h+="utf8=%26%2310003%3B&":h+="utf8=%E2%9C%93&"),u.length>0?h+u:""}(e,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${e7}`}defaultIdempotencyKey(){return`stainless-node-retry-${eM()}`}makeStatusError(e,t,s,r){return eB.generate(e,t,s,r)}buildURL(e,t,s){let r=!eC(this,eO,"m",e$).call(this)&&s||this.baseURL,n=new URL(e2(e)?e:r+(r.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),i=this.defaultQuery();return!function(e){if(!e)return!0;for(let t in e)return!1;return!0}(i)&&(t={...i,...t}),"object"==typeof t&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}async prepareOptions(e){}async prepareRequest(e,{url:t,options:s}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,s){return this.request(Promise.resolve(s).then(s=>({method:e,path:t,...s})))}request(e,t=null){return new tq(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,s){let r=await e,n=r.maxRetries??this.maxRetries;null==t&&(t=n),await this.prepareOptions(r);let{req:i,url:a,timeout:o}=await this.buildRequest(r,{retryCount:n-t});await this.prepareRequest(i,{url:a,options:r});let l="log_"+(0x1000000*Math.random()|0).toString(16).padStart(6,"0"),c=void 0===s?"":`, retryOf: ${s}`,u=Date.now();if(tE(this).debug(`[${l}] sending request`,tI({retryOfRequestLogID:s,method:r.method,url:a,options:r,headers:i.headers})),r.signal?.aborted)throw new eU;let h=new AbortController,d=await this.fetchWithTimeout(a,i,o,h).catch(eD),f=Date.now();if(d instanceof Error){let e=`retrying, ${t} attempts remaining`;if(r.signal?.aborted)throw new eU;let n=eq(d)||/timed? ?out/i.test(String(d)+("cause"in d?String(d.cause):""));if(t)return tE(this).info(`[${l}] connection ${n?"timed out":"failed"} - ${e}`),tE(this).debug(`[${l}] connection ${n?"timed out":"failed"} (${e})`,tI({retryOfRequestLogID:s,url:a,durationMs:f-u,message:d.message})),this.retryRequest(r,t,s??l);if(tE(this).info(`[${l}] connection ${n?"timed out":"failed"} - error; no more retries left`),tE(this).debug(`[${l}] connection ${n?"timed out":"failed"} (error; no more retries left)`,tI({retryOfRequestLogID:s,url:a,durationMs:f-u,message:d.message})),n)throw new eF;throw new eW({cause:d})}let p=[...d.headers.entries()].filter(([e])=>"x-request-id"===e).map(([e,t])=>", "+e+": "+JSON.stringify(t)).join(""),m=`[${l}${c}${p}] ${i.method} ${a} ${d.ok?"succeeded":"failed"} with status ${d.status} in ${f-u}ms`;if(!d.ok){let e=await this.shouldRetry(d);if(t&&e){let e=`retrying, ${t} attempts remaining`;return await tl(d.body),tE(this).info(`${m} - ${e}`),tE(this).debug(`[${l}] response error (${e})`,tI({retryOfRequestLogID:s,url:d.url,status:d.status,headers:d.headers,durationMs:f-u})),this.retryRequest(r,t,s??l,d.headers)}let n=e?"error; no more retries left":"error; not retryable";tE(this).info(`${m} - ${n}`);let i=await d.text().catch(e=>eD(e).message),a=e5(i),o=a?void 0:i;throw tE(this).debug(`[${l}] response error (${n})`,tI({retryOfRequestLogID:s,url:d.url,status:d.status,headers:d.headers,message:o,durationMs:Date.now()-u})),this.makeStatusError(d.status,a,o,d.headers)}return tE(this).info(m),tE(this).debug(`[${l}] response start`,tI({retryOfRequestLogID:s,url:d.url,status:d.status,headers:d.headers,durationMs:f-u})),{response:d,options:r,controller:h,requestLogID:l,retryOfRequestLogID:s,startTime:u}}getAPIList(e,t,s){return this.requestAPIList(t,{method:"get",path:e,...s})}requestAPIList(e,t){return new tL(this,this.makeRequest(t,null,void 0),e)}async fetchWithTimeout(e,t,s,r){let{signal:n,method:i,...a}=t||{};n&&n.addEventListener("abort",()=>r.abort());let o=setTimeout(()=>r.abort(),s),l=globalThis.ReadableStream&&a.body instanceof globalThis.ReadableStream||"object"==typeof a.body&&null!==a.body&&Symbol.asyncIterator in a.body,c={signal:r.signal,...l?{duplex:"half"}:{},method:"GET",...a};i&&(c.method=i.toUpperCase());try{return await this.fetch.call(void 0,e,c)}finally{clearTimeout(o)}}async shouldRetry(e){let t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||409===e.status||429===e.status||!!(e.status>=500))}async retryRequest(e,t,s,r){let n,i=r?.get("retry-after-ms");if(i){let e=parseFloat(i);Number.isNaN(e)||(n=e)}let a=r?.get("retry-after");if(a&&!n){let e=parseFloat(a);n=Number.isNaN(e)?Date.parse(a)-Date.now():1e3*e}if(!(n&&0<=n&&n<6e4)){let s=e.maxRetries??this.maxRetries;n=this.calculateDefaultRetryTimeoutMillis(t,s)}return await e9(n),this.makeRequest(e,t-1,s)}calculateDefaultRetryTimeoutMillis(e,t){return Math.min(.5*Math.pow(2,t-e),8)*(1-.25*Math.random())*1e3}async buildRequest(e,{retryCount:t=0}={}){let s={...e},{method:r,path:n,query:i,defaultBaseURL:a}=s,o=this.buildURL(n,i,a);"timeout"in s&&e8("timeout",s.timeout),s.timeout=s.timeout??this.timeout;let{bodyHeaders:l,body:c}=this.buildBody({options:s}),u=await this.buildHeaders({options:e,method:r,bodyHeaders:l,retryCount:t});return{req:{method:r,headers:u,...s.signal&&{signal:s.signal},...globalThis.ReadableStream&&c instanceof globalThis.ReadableStream&&{duplex:"half"},...c&&{body:c},...this.fetchOptions??{},...s.fetchOptions??{}},url:o,timeout:s.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:s,retryCount:r}){let n={};this.idempotencyHeader&&"get"!==t&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),n[this.idempotencyHeader]=e.idempotencyKey);let i=sy([n,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(r),...e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{},...tn(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},await this.authHeaders(e),this._options.defaultHeaders,s,e.headers]);return this.validateHeaders(i),i.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};let s=sy([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||"string"==typeof e&&s.values.has("content-type")||e instanceof Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:"object"==typeof e&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&"function"==typeof e.next)?{bodyHeaders:void 0,body:ta(e)}:eC(this,eA,"f").call(this,{body:e,headers:s})}}eR=ro,eA=new WeakMap,eO=new WeakSet,e$=function(){return"https://api.openai.com/v1"!==this.baseURL},ro.OpenAI=eR,ro.DEFAULT_TIMEOUT=6e5,ro.OpenAIError=eL,ro.APIError=eB,ro.APIConnectionError=eW,ro.APIConnectionTimeoutError=eF,ro.APIUserAbortError=eU,ro.NotFoundError=eJ,ro.ConflictError=eV,ro.RateLimitError=eG,ro.BadRequestError=eX,ro.AuthenticationError=eH,ro.InternalServerError=eQ,ro.PermissionDeniedError=ez,ro.UnprocessableEntityError=eK,ro.InvalidWebhookSignatureError=e0,ro.toFile=t2,ro.Completions=sq,ro.Chat=sb,ro.Embeddings=sU,ro.Files=sH,ro.Images=s2,ro.Audio=sS,ro.Moderations=s4,ro.Models=s3,ro.FineTuning=sZ,ro.Graders=s1,ro.VectorStores=ri,ro.Webhooks=ra,ro.Beta=sM,ro.Batches=sk,ro.Uploads=rt,ro.Responses=s7,ro.Evals=sX,ro.Containers=sB;let rl=new ro({baseURL:"https://openrouter.ai/api/v1",apiKey:process.env.OPENROUTER_API_KEY||"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",defaultHeaders:{"HTTP-Referer":"http://localhost:3000","X-Title":"Portfolio Chat","Content-Type":"application/json"}}),rc="tngtech/deepseek-r1t2-chimera:free";async function ru(e){try{let{message:t}=await e.json();if(!t)return ej.NextResponse.json({error:"Message is required"},{status:400});let s=await rl.chat.completions.create({model:rc,messages:[{role:"system",content:"You are a helpful assistant embedded in a portfolio website. Keep responses concise and professional."},{role:"user",content:t}],temperature:.7});console.log("OpenRouter Request:",{model:rc,message:t.substring(0,100)+(t.length>100?"...":"")}),console.log("OpenRouter Response:",{id:s.id,model:s.model,usage:s.usage});let r=s.choices[0]?.message?.content||"Sorry, I could not process your request.";return ej.NextResponse.json({response:r})}catch(e){return console.error("OpenRouter API error:",e),ej.NextResponse.json({error:"Error processing your request"},{status:500})}}let rh=new eI.AppRouteRouteModule({definition:{kind:eP.RouteKind.APP_ROUTE,page:"/api/chat/route",pathname:"/api/chat",filename:"route",bundlePath:"app/api/chat/route"},resolvedPagePath:"C:\\Users\\nikes\\OneDrive\\Desktop\\Project\\portfolio\\app\\api\\chat\\route.ts",nextConfigOutput:"export",userland:eE}),{workAsyncStorage:rd,workUnitAsyncStorage:rf,serverHooks:rp}=rh;function rm(){return(0,eT.patchFetch)({workAsyncStorage:rd,workUnitAsyncStorage:rf})}},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1243:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"URLPattern",{enumerable:!0,get:function(){return s}});let s="undefined"==typeof URLPattern?void 0:URLPattern},2079:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"unstable_rootParams",{enumerable:!0,get:function(){return u}});let r=s(1617),n=s(4971),i=s(9294),a=s(3033),o=s(8388),l=s(2609),c=new WeakMap;async function u(){let e=i.workAsyncStorage.getStore();if(!e)throw Object.defineProperty(new r.InvariantError("Missing workStore in unstable_rootParams"),"__NEXT_ERROR_CODE",{value:"E615",enumerable:!1,configurable:!0});let t=a.workUnitAsyncStorage.getStore();if(!t)throw Object.defineProperty(Error(`Route ${e.route} used \`unstable_rootParams()\` in Pages Router. This API is only available within App Router.`),"__NEXT_ERROR_CODE",{value:"E641",enumerable:!1,configurable:!0});switch(t.type){case"unstable-cache":case"cache":throw Object.defineProperty(Error(`Route ${e.route} used \`unstable_rootParams()\` inside \`"use cache"\` or \`unstable_cache\`. Support for this API inside cache scopes is planned for a future version of Next.js.`),"__NEXT_ERROR_CODE",{value:"E642",enumerable:!1,configurable:!0});case"prerender":case"prerender-ppr":case"prerender-legacy":return function(e,t,s){let r=t.fallbackRouteParams;if(r){let d=!1;for(let t in e)if(r.has(t)){d=!0;break}if(d){if("prerender"===s.type){let t=c.get(e);if(t)return t;let r=(0,o.makeHangingPromise)(s.renderSignal,"`unstable_rootParams`");return c.set(e,r),r}var i=e,a=r,u=t,h=s;let d=c.get(i);if(d)return d;let f={...i},p=Promise.resolve(f);return c.set(i,p),Object.keys(i).forEach(e=>{l.wellKnownProperties.has(e)||(a.has(e)?Object.defineProperty(f,e,{get(){let t=(0,l.describeStringPropertyAccess)("unstable_rootParams",e);"prerender-ppr"===h.type?(0,n.postponeWithTracking)(u.route,t,h.dynamicTracking):(0,n.throwToInterruptStaticGeneration)(t,u,h)},enumerable:!0}):p[e]=i[e])}),p}}return Promise.resolve(e)}(t.rootParams,e,t);default:return Promise.resolve(t.rootParams)}}},2174:(e,t)=>{"use strict";function s(){throw Object.defineProperty(Error('ImageResponse moved from "next/server" to "next/og" since Next.js 14, please import from "next/og" instead'),"__NEXT_ERROR_CODE",{value:"E183",enumerable:!1,configurable:!0})}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ImageResponse",{enumerable:!0,get:function(){return s}})},2944:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"connection",{enumerable:!0,get:function(){return c}});let r=s(9294),n=s(3033),i=s(4971),a=s(23),o=s(8388),l=s(8719);function c(){let e=r.workAsyncStorage.getStore(),t=n.workUnitAsyncStorage.getStore();if(e){if(t&&"after"===t.phase&&!(0,l.isRequestAPICallableInsideAfter)())throw Object.defineProperty(Error(`Route ${e.route} used "connection" inside "after(...)". The \`connection()\` function is used to indicate the subsequent code must only run when there is an actual Request, but "after(...)" executes after the request, so this function is not allowed in this scope. See more info here: https://nextjs.org/docs/canary/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E186",enumerable:!1,configurable:!0});if(e.forceStatic)return Promise.resolve(void 0);if(t){if("cache"===t.type)throw Object.defineProperty(Error(`Route ${e.route} used "connection" inside "use cache". The \`connection()\` function is used to indicate the subsequent code must only run when there is an actual Request, but caches must be able to be produced before a Request so this function is not allowed in this scope. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E111",enumerable:!1,configurable:!0});else if("unstable-cache"===t.type)throw Object.defineProperty(Error(`Route ${e.route} used "connection" inside a function cached with "unstable_cache(...)". The \`connection()\` function is used to indicate the subsequent code must only run when there is an actual Request, but caches must be able to be produced before a Request so this function is not allowed in this scope. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E1",enumerable:!1,configurable:!0})}if(e.dynamicShouldError)throw Object.defineProperty(new a.StaticGenBailoutError(`Route ${e.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`connection\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E562",enumerable:!1,configurable:!0});if(t)if("prerender"===t.type)return(0,o.makeHangingPromise)(t.renderSignal,"`connection()`");else"prerender-ppr"===t.type?(0,i.postponeWithTracking)(e.route,"connection",t.dynamicTracking):"prerender-legacy"===t.type&&(0,i.throwToInterruptStaticGeneration)("connection",e,t);(0,i.trackDynamicDataInDynamicRender)(e,t)}return Promise.resolve(void 0)}},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3182:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{isBot:function(){return n},userAgent:function(){return a},userAgentFromString:function(){return i}});let r=function(e){return e&&e.__esModule?e:{default:e}}(s(397));function n(e){return/Googlebot|Mediapartners-Google|AdsBot-Google|googleweblight|Storebot-Google|Google-PageRenderer|Google-InspectionTool|Bingbot|BingPreview|Slurp|DuckDuckBot|baiduspider|yandex|sogou|LinkedInBot|bitlybot|tumblr|vkShare|quora link preview|facebookexternalhit|facebookcatalog|Twitterbot|applebot|redditbot|Slackbot|Discordbot|WhatsApp|SkypeUriPreview|ia_archiver/i.test(e)}function i(e){return{...(0,r.default)(e),isBot:void 0!==e&&n(e)}}function a({headers:e}){return i(e.get("user-agent")||void 0)}},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3381:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){Object.keys(e).forEach(function(s){"default"===s||Object.prototype.hasOwnProperty.call(t,s)||Object.defineProperty(t,s,{enumerable:!0,get:function(){return e[s]}})})}(s(4871),t)},3426:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"NextResponse",{enumerable:!0,get:function(){return h}});let r=s(3158),n=s(6608),i=s(7912),a=s(3763),o=s(3158),l=Symbol("internal response"),c=new Set([301,302,303,307,308]);function u(e,t){var s;if(null==e||null==(s=e.request)?void 0:s.headers){if(!(e.request.headers instanceof Headers))throw Object.defineProperty(Error("request.headers must be an instance of Headers"),"__NEXT_ERROR_CODE",{value:"E119",enumerable:!1,configurable:!0});let s=[];for(let[r,n]of e.request.headers)t.set("x-middleware-request-"+r,n),s.push(r);t.set("x-middleware-override-headers",s.join(","))}}class h extends Response{constructor(e,t={}){super(e,t);let s=this.headers,c=new Proxy(new o.ResponseCookies(s),{get(e,n,i){switch(n){case"delete":case"set":return(...i)=>{let a=Reflect.apply(e[n],e,i),l=new Headers(s);return a instanceof o.ResponseCookies&&s.set("x-middleware-set-cookie",a.getAll().map(e=>(0,r.stringifyCookie)(e)).join(",")),u(t,l),a};default:return a.ReflectAdapter.get(e,n,i)}}});this[l]={cookies:c,url:t.url?new n.NextURL(t.url,{headers:(0,i.toNodeOutgoingHttpHeaders)(s),nextConfig:t.nextConfig}):void 0}}[Symbol.for("edge-runtime.inspect.custom")](){return{cookies:this.cookies,url:this.url,body:this.body,bodyUsed:this.bodyUsed,headers:Object.fromEntries(this.headers),ok:this.ok,redirected:this.redirected,status:this.status,statusText:this.statusText,type:this.type}}get cookies(){return this[l].cookies}static json(e,t){let s=Response.json(e,t);return new h(s.body,s)}static redirect(e,t){let s="number"==typeof t?t:(null==t?void 0:t.status)??307;if(!c.has(s))throw Object.defineProperty(RangeError('Failed to execute "redirect" on "response": Invalid status code'),"__NEXT_ERROR_CODE",{value:"E529",enumerable:!1,configurable:!0});let r="object"==typeof t?t:{},n=new Headers(null==r?void 0:r.headers);return n.set("Location",(0,i.validateURL)(e)),new h(null,{...r,headers:n,status:s})}static rewrite(e,t){let s=new Headers(null==t?void 0:t.headers);return s.set("x-middleware-rewrite",(0,i.validateURL)(e)),u(t,s),new h(null,{...t,headers:s})}static next(e){let t=new Headers(null==e?void 0:e.headers);return t.set("x-middleware-next","1"),u(e,t),new h(null,{...e,headers:t})}}},4525:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{ImageResponse:function(){return r.ImageResponse},NextRequest:function(){return n.NextRequest},NextResponse:function(){return i.NextResponse},URLPattern:function(){return o.URLPattern},after:function(){return l.after},connection:function(){return c.connection},unstable_rootParams:function(){return u.unstable_rootParams},userAgent:function(){return a.userAgent},userAgentFromString:function(){return a.userAgentFromString}});let r=s(2174),n=s(6268),i=s(3426),a=s(3182),o=s(1243),l=s(3381),c=s(2944),u=s(2079)},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4871:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"after",{enumerable:!0,get:function(){return n}});let r=s(9294);function n(e){let t=r.workAsyncStorage.getStore();if(!t)throw Object.defineProperty(Error("`after` was called outside a request scope. Read more: https://nextjs.org/docs/messages/next-dynamic-api-wrong-context"),"__NEXT_ERROR_CODE",{value:"E468",enumerable:!1,configurable:!0});let{afterContext:s}=t;return s.after(e)}},6487:()=>{},6559:(e,t,s)=>{"use strict";e.exports=s(4870)},8335:()=>{},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[447],()=>s(720));module.exports=r})();