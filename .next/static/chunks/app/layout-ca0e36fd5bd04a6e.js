(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{3028:(e,t,r)=>{"use strict";r.d(t,{ChatButton:()=>P});var a=r(5155),s=r(2115),i=r(760),n=r(6408),l=r(2596),o=r(9688);function d(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,o.QP)((0,l.$)(t))}let c=s.forwardRef((e,t)=>{let{className:r,type:s,...i}=e;return(0,a.jsx)("input",{type:s,className:d("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...i})});c.displayName="Input";var m=r(4621);let u=s.forwardRef((e,t)=>{let{className:r,children:s,...i}=e;return(0,a.jsxs)(m.bL,{ref:t,className:d("relative overflow-hidden",r),...i,children:[(0,a.jsx)(m.LM,{className:"h-full w-full rounded-[inherit]",children:s}),(0,a.jsx)(g,{}),(0,a.jsx)(m.OK,{})]})});u.displayName=m.bL.displayName;let g=s.forwardRef((e,t)=>{let{className:r,orientation:s="vertical",...i}=e;return(0,a.jsx)(m.VM,{ref:t,orientation:s,className:d("flex touch-none select-none transition-colors","vertical"===s&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===s&&"h-2.5 border-t border-t-transparent p-[1px]",r),...i,children:(0,a.jsx)(m.lr,{className:"relative flex-1 rounded-full bg-border"})})});g.displayName=m.VM.displayName;let h="chat-messages",x=()=>{let e=localStorage.getItem(h);if(!e)return[];try{return JSON.parse(e).map(e=>({...e,id:e.id||"msg-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),timestamp:e.timestamp||Date.now(),role:e.role||"user",content:e.content||""}))}catch(e){return console.error("Failed to parse messages from localStorage",e),[]}},y=e=>{try{localStorage.setItem(h,JSON.stringify(e))}catch(e){console.error("Error saving messages to localStorage:",e)}};var p=r(5339),f=r(5657),b=r(1007),v=r(4416),w=r(1154),j=r(429);let N={hidden:{opacity:0,y:10},visible:{opacity:1,y:0,transition:{type:"spring",stiffness:300,damping:25}}};function k(e){let{onError:t,onClose:r}=e,[l,o]=(0,s.useState)([]),[m,g]=(0,s.useState)(""),[h,k]=(0,s.useState)(!1),[S,A]=(0,s.useState)(null),[P,E]=(0,s.useState)(!1),C=(0,s.useRef)(null),D=(0,s.useRef)(new Set),O=(0,s.useCallback)(()=>{let e="undefined"!=typeof crypto?crypto.getRandomValues(new Uint32Array(1))[0].toString(36):Math.random().toString(36).substring(2,15),t=Date.now(),r="msg-".concat(t,"-").concat(e);if(D.current.has(r)){let e=1,t=r;for(;D.current.has(t)&&e<100;)t="".concat(r,"-").concat(e),e++;return D.current.add(t),t}return D.current.add(r),r},[]),I=(0,s.useCallback)(e=>{if(!Array.isArray(e))return[];let t=new Set,r=[];return e.forEach(e=>{try{if(!e||"object"!=typeof e||!e.role)return void console.warn("Skipping invalid message (missing role or invalid format):",e);let a=String(e.content||"").trim();if(!a)return void console.warn("Skipping empty message content");let s="".concat(e.role,"-").concat(a.substring(0,100));if(t.has(s))return void console.warn("Skipping duplicate message content:",s);t.add(s);let i=O(),n="number"!=typeof e.timestamp||isNaN(e.timestamp)?Date.now():e.timestamp;r.push({id:i,role:"assistant"===e.role?"assistant":"user",content:a,timestamp:n})}catch(t){console.error("Error processing message:",t,"Message:",e)}}),r.sort((e,t)=>(e.timestamp||0)-(t.timestamp||0))},[O]);(0,s.useEffect)(()=>{try{let e=x(),t=I(Array.isArray(e)?e:[]).filter(e=>{let t=(null==e?void 0:e.id)&&"string"==typeof e.id&&""!==e.id.trim(),r=(null==e?void 0:e.content)&&"string"==typeof e.content&&""!==e.content.trim(),a=(null==e?void 0:e.role)&&("user"===e.role||"assistant"===e.role);return!!t&&!!r&&!!a||(console.warn("Skipping invalid message:",e),!1)}).sort((e,t)=>(e.timestamp||0)-(t.timestamp||0)),r=new Set,a=t.map(e=>{let t=O();for(;r.has(t);)t=O();return r.add(t),{...e,id:t,content:String(e.content).trim(),timestamp:e.timestamp||Date.now()}});D.current=new Set(r),o(a),y(a),A(null)}catch(e){console.error("Error loading messages:",e)}return E(!0),()=>E(!1)},[I,O]),(0,s.useEffect)(()=>{var e;null==(e=C.current)||e.scrollIntoView({behavior:"smooth"})},[l]);let M=async e=>{e.preventDefault();let t=m.trim();if(!t||h)return;let r=O(),a={id:r,role:"user",content:t,timestamp:Date.now()};g(""),o(e=>{let t=[...e.filter(e=>(null==e?void 0:e.id)&&"string"==typeof e.id&&""!==e.id.trim()&&e.id!==r),a];return y(t),t}),k(!0);try{let e=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:t})});if(!e.ok)throw Error("Error: ".concat(e.status));let r=await e.json(),a={id:O(),role:"assistant",content:r.response||"Sorry, I encountered an error.",timestamp:Date.now()};o(e=>{let t=[...e.filter(e=>"..."!==e.content),a];return y(t),t})}catch(t){console.error("Error:",t),A("Failed to send message. Please try again.");let e={id:O(),role:"assistant",content:"Sorry, something went wrong. Please try again.",timestamp:Date.now()};o(t=>{let r=[...t.filter(e=>"..."!==e.content),e];return y(r),r})}finally{k(!1)}};return P?(0,a.jsxs)("div",{className:"flex flex-col h-full bg-white dark:bg-gray-800",children:[(0,a.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,a.jsx)(u,{className:"h-full w-full",children:(0,a.jsxs)("div",{className:"flex flex-col p-4 space-y-3",children:[!1,S&&(0,a.jsx)(n.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0},className:"bg-red-100 dark:bg-red-900/50 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-200 px-4 py-3 rounded-md text-sm mb-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(p.A,{className:"h-4 w-4 mr-2"}),S]})}),0===l.length&&(0,a.jsxs)(n.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col items-center justify-center text-center py-12 px-4",children:[(0,a.jsx)("div",{className:"p-3 mb-4 rounded-full bg-gray-100 dark:bg-gray-700",children:(0,a.jsx)(f.A,{className:"h-8 w-8 text-gray-400"})}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-1",children:"How can I help you today?"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 max-w-xs",children:"Ask me anything about my work, experience, or just say hi!"})]}),(0,a.jsx)(i.N,{children:[...new Map(l.filter(e=>e.id&&"string"==typeof e.id&&""!==e.id.trim()).map(e=>[e.id,e])).values()].map((e,t)=>(0,a.jsx)(n.P.div,{variants:N,initial:"hidden",animate:"visible",exit:{opacity:0,x:-20},className:d("flex","user"===e.role?"justify-end":"justify-start"),children:(0,a.jsx)("div",{className:d("flex max-w-[85%] rounded-2xl px-4 py-2.5","user"===e.role?"bg-blue-600 text-white rounded-br-sm":"bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-100 rounded-bl-sm shadow-sm"),children:(0,a.jsxs)("div",{className:"flex items-start gap-2.5",children:["assistant"===e.role&&(0,a.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:(0,a.jsx)(f.A,{className:"h-5 w-5 text-gray-600 dark:text-gray-300"})}),(0,a.jsx)("div",{className:d("text-sm leading-relaxed whitespace-pre-wrap break-words","user"===e.role?"text-white":"text-gray-800 dark:text-gray-100"),children:e.content}),"user"===e.role&&(0,a.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:(0,a.jsx)(b.A,{className:"h-5 w-5 text-blue-200"})})]})})},e.id||"fallback-key-".concat(t)))}),h&&(0,a.jsx)(n.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex justify-start",children:(0,a.jsx)("div",{className:"bg-gray-100 dark:bg-gray-700 rounded-2xl px-4 py-2.5 rounded-bl-sm",children:(0,a.jsxs)("div",{className:"flex items-center space-x-1.5",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full bg-gray-400 animate-bounce",style:{animationDelay:"0ms"}}),(0,a.jsx)("div",{className:"w-2 h-2 rounded-full bg-gray-400 animate-bounce",style:{animationDelay:"150ms"}}),(0,a.jsx)("div",{className:"w-2 h-2 rounded-full bg-gray-400 animate-bounce",style:{animationDelay:"300ms"}})]})})}),(0,a.jsx)("div",{ref:C})]})})}),(0,a.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-700 p-4 bg-white dark:bg-gray-800",children:(0,a.jsxs)("form",{onSubmit:M,className:"flex items-center gap-2",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(c,{type:"text",value:m,onChange:e=>g(e.target.value),placeholder:"Type your message...",className:d("flex-1 bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600","focus:border-blue-500 focus:ring-blue-500","placeholder-gray-500 dark:placeholder-gray-400","text-gray-900 dark:text-white","pr-10"),disabled:h}),m&&(0,a.jsx)("button",{type:"button",onClick:()=>g(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors","aria-label":"Clear input",children:(0,a.jsx)(v.A,{className:"h-4 w-4"})})]}),(0,a.jsx)("button",{type:"submit",disabled:h||!m.trim(),className:d("inline-flex items-center justify-center rounded-md px-4 py-2 text-sm font-medium transition-colors","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2","disabled:opacity-50 disabled:pointer-events-none","bg-blue-600 text-white hover:bg-blue-700","dark:bg-blue-700 dark:hover:bg-blue-600","min-w-[80px]",h?"opacity-70 cursor-not-allowed":""),children:h?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(w.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j.A,{className:"mr-2 h-4 w-4"}),"Send"]})})]})})]}):null}var S=r(1497);let A={hidden:{opacity:0,scale:.8,y:20},visible:{opacity:1,scale:1,y:0,transition:{type:"spring",stiffness:300,damping:20}},hover:{scale:1.05},tap:{scale:.95}};function P(){let[e,t]=(0,s.useState)(!1),[r,l]=(0,s.useState)(!1),[o,c]=(0,s.useState)(!1),[m,u]=(0,s.useState)(!1);(0,s.useEffect)(()=>(c(!0),()=>c(!1)),[]);let g=()=>{t(!e)};return(0,a.jsxs)("div",{className:"fixed bottom-6 right-6 z-50 flex flex-col items-end gap-4",style:{zIndex:9999},children:[(0,a.jsx)(i.N,{children:e&&(0,a.jsx)(n.P.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.95},transition:{type:"spring",stiffness:300,damping:25},className:"relative",children:(0,a.jsxs)("div",{className:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700 w-[350px] h-[500px] flex flex-col overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-100 dark:border-gray-700 bg-gray-50 dark:bg-gray-900/50",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Chat with me"}),(0,a.jsx)("button",{onClick:g,className:"h-8 w-8 rounded-full p-0 flex items-center justify-center hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white","aria-label":"Close chat",children:(0,a.jsx)(v.A,{className:"h-4 w-4"})})]}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,a.jsx)(k,{onError:e=>{l(e)}})})]})})}),(0,a.jsxs)(n.P.div,{initial:!1,animate:e?"hidden":"visible",variants:A,whileHover:e?{}:"hover",whileTap:e?{}:"tap",onHoverStart:()=>u(!0),onHoverEnd:()=>u(!1),className:d("relative",e&&"pointer-events-none"),children:[(0,a.jsx)("button",{onClick:g,className:d("h-14 w-14 rounded-full shadow-lg transition-all duration-200 group","flex items-center justify-center",r?"bg-destructive text-destructive-foreground hover:bg-destructive/90 ring-2 ring-red-500 ring-offset-2":"bg-primary text-primary-foreground hover:bg-primary/90",e?"opacity-0":"opacity-100"),"aria-label":r?"Open chat (error occurred)":"Open chat",children:r?(0,a.jsx)(p.A,{className:"h-6 w-6"}):(0,a.jsx)(S.A,{className:"h-6 w-6 transition-transform group-hover:scale-110"})}),m&&!e&&(0,a.jsx)(n.P.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},className:"absolute right-16 top-1/2 -translate-y-1/2 bg-gray-900 text-white text-sm px-3 py-1.5 rounded-md whitespace-nowrap shadow-lg",children:"Need help? Chat with me"})]})]})}},3121:(e,t,r)=>{Promise.resolve().then(r.bind(r,3028)),Promise.resolve().then(r.t.bind(r,929,23)),Promise.resolve().then(r.t.bind(r,2353,23)),Promise.resolve().then(r.t.bind(r,7275,23)),Promise.resolve().then(r.t.bind(r,9324,23))},9324:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[246,395,441,684,358],()=>t(3121)),_N_E=e.O()}]);